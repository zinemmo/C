#include "unity.h"
#include "unity_fixture.h"
#include "../../crypto/src/crypt.h"
#include <stdlib.h>
#include <stdio.h>
#include <string.h>


unsigned int *cipher;
int *key;
unsigned int *plan;

TEST_GROUP(Crypto);

TEST_SETUP(Crypto)
{
    key = malloc(sizeof(int) * 8);
    plan = malloc(sizeof(unsigned int) * 4);
    cipher = malloc(sizeof(unsigned int) * 4);
    key[0] = 0xDEADBEEFL;
    key[1] = 0x01234567L;
    key[2] = 0x89ABCDEFL;
    key[3] = 0xDEADBEEFL;
    key[4] = 0xDEADBEEFL;
    key[5] = 0x01234567L;
    key[6] = 0x89ABCDEFL;
    key[7] = 0xDEADBEEFL;
    plan[0] = 0xA5A5A5A5L;
    plan[1] = 0x01234567L;
    plan[2] = 0xFEDCBA98L;
    plan[3] = 0x5A5A5A5AL;
}

TEST_TEAR_DOWN(Crypto)
{
    free(key);
    free(plan);
    free(cipher);
}

//-----------------------------------------------------------------------------
// XTEA ENC
//-----------------------------------------------------------------------------
TEST(Crypto, xtea_enc_test_const)
{   
    int i;
    unsigned int* d[4];
    unsigned int* dAux[4];
    const unsigned int* v[4];
    const unsigned int* vAux[4];
    const unsigned int* k[4];
    const unsigned int* kAux[4];

    for(i = 0; i < 4; i++) {
        d[i] = &cipher[3-i];
        dAux[i] = d[i];
        v[i] = &plan[3-i];
        vAux[i] = v[i];
        k[i] = &key[3-i];
        kAux[i] = k[i];
    }

    xtea_enc(d,v,k);

    TEST_ASSERT_EQUAL_INT_ARRAY(dAux, d, 4);
    TEST_ASSERT_EQUAL_UINT_ARRAY(vAux, v, 4);
    TEST_ASSERT_EQUAL_UINT_ARRAY(kAux, k, 4);
}

TEST(Crypto, xtea_enc_test_encrypt)
{   
    int i;
    unsigned int* d[4];
    const unsigned int* v[4];
    const unsigned int* k[4];
    unsigned int expected[4] = {0x089975E9, 0x2555F334, 0xCE76E4F2, 0x4D932AB3};

    for(i = 0; i < 4; i++) {
        d[i] = &cipher[3-i];
        v[i] = &plan[3-i];
        k[i] = &key[3-i];
    }

    xtea_enc(d,v,k);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, xtea_enc_test_encrypt_key_128)
{   
    int i;
    unsigned int* d[4];
    const unsigned int* v[4];
    const unsigned int* k[4];
    unsigned int auxKey[4] = {0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF};
    unsigned int expected[4] = {0x3BCA3FC6, 0x8075C5D0, 0xA690F512, 0xD84463CC};

    for(i = 0; i < 4; i++) {
        d[i] = &cipher[3-i];
        v[i] = &plan[3-i];
        k[i] = &auxKey[3-i];
    }

    xtea_enc(d,v,k);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, xtea_enc_test_encrypt_key_192)
{   
    int i;
    unsigned int* d[4];
    const unsigned int* v[4];
    const unsigned int* k[4];
    unsigned int auxKey[6] = {0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF};
    unsigned int expected[4] = {0x3BCA3FC6, 0x8075C5D0, 0xA690F512, 0xD84463CC};

    for(i = 0; i < 4; i++) {
        d[i] = &cipher[3-i];
        v[i] = &plan[3-i];
        k[i] = &auxKey[3-i];
    }

    xtea_enc(d,v,k);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, xtea_enc_test_encrypt_key_256_plus)
{   
    int i;
    unsigned int* d[4];
    const unsigned int* v[4];
    const unsigned int* k[4];
    unsigned int auxKey[8] = {0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF};
    unsigned int expected[4] = {0x3BCA3FC6, 0x8075C5D0, 0xA690F512, 0xD84463CC};

    for(i = 0; i < 4; i++) {
        d[i] = &cipher[3-i];
        v[i] = &plan[3-i];
        k[i] = &auxKey[3-i];
    }

    xtea_enc(d,v,k);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

//-----------------------------------------------------------------------------
// XTEA DEC
//-----------------------------------------------------------------------------
TEST(Crypto, xtea_dec_test_const)
{   
    int i;
    unsigned int* d[4];
    unsigned int* dAux[4];
    const unsigned int* v[4];
    const unsigned int* vAux[4];
    const unsigned int* k[4];
    const unsigned int* kAux[4];

    for(i = 0; i < 4; i++) {
        d[i] = &cipher[3-i];
        dAux[i] = d[i];
        v[i] = &plan[3-i];
        vAux[i] = v[i];
        k[i] = &key[3-i];
        kAux[i] = k[i];
    }

    xtea_dec(d,v,k);

    TEST_ASSERT_EQUAL_INT_ARRAY(dAux, d, 4);
    TEST_ASSERT_EQUAL_UINT_ARRAY(vAux, v, 4);
    TEST_ASSERT_EQUAL_UINT_ARRAY(kAux, k, 4);
}

TEST(Crypto, xtea_enc_test_decrypt)
{   
    int i;
    unsigned int* d[4];
    const unsigned int* v[4];
    const unsigned int* k[4];
    unsigned int expected[4] = {0x089975E9, 0x2555F334, 0xCE76E4F2, 0x4D932AB3};

    for(i = 0; i < 4; i++) {
        d[i] = &cipher[3-i];
        v[i] = &expected[3-i];
        k[i] = &key[3-i];
    }

    xtea_dec(d,v,k);

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
}

TEST(Crypto, xtea_dec_test_decrypt_key_128)
{   
    int i;
    unsigned int* d[4];
    const unsigned int* v[4];
    const unsigned int* k[4];
    unsigned int auxKey[4] = {0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF};
    unsigned int expected[4] = {0x3BCA3FC6, 0x8075C5D0, 0xA690F512, 0xD84463CC};

    for(i = 0; i < 4; i++) {
        d[i] = &cipher[3-i];
        v[i] = &expected[3-i];
        k[i] = &auxKey[3-i];
    }

    xtea_dec(d,v,k);

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
}

TEST(Crypto, xtea_dec_test_decrypt_key_192)
{   
    int i;
    unsigned int* d[4];
    const unsigned int* v[4];
    const unsigned int* k[4];
    unsigned int auxKey[6] = {0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF};
    unsigned int expected[4] = {0x3BCA3FC6, 0x8075C5D0, 0xA690F512, 0xD84463CC};

    for(i = 0; i < 4; i++) {
        d[i] = &cipher[3-i];
        v[i] = &expected[3-i];
        k[i] = &auxKey[3-i];
    }

    xtea_dec(d,v,k);

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
}

TEST(Crypto, xtea_dec_test_decrypt_key_256_plus)
{   
    int i;
    unsigned int* d[4];
    const unsigned int* v[4];
    const unsigned int* k[4];
    unsigned int auxKey[8] = {0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF};
    unsigned int expected[4] = {0x3BCA3FC6, 0x8075C5D0, 0xA690F512, 0xD84463CC};

    for(i = 0; i < 4; i++) {
        d[i] = &cipher[3-i];
        v[i] = &expected[3-i];
        k[i] = &auxKey[3-i];
    }

    xtea_dec(d,v,k);

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
}

//-----------------------------------------------------------------------------
// XTEA
//-----------------------------------------------------------------------------
TEST(Crypto, xtea_should_run_enc)
{
    unsigned int aux[4] = {
        0x089975E9, 0x2555F334,
        0xCE76E4F2, 0x4D932AB3
    };

    xtea(key,plan,1,cipher);
    TEST_ASSERT_EQUAL_UINT_ARRAY(aux, cipher, 4);
}

TEST(Crypto, xtea_should_run_dec)
{
    unsigned int aux[4] = {
        0x089975E9, 0x2555F334,
        0xCE76E4F2, 0x4D932AB3
    };

    xtea(key,aux,0,cipher);
    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
}

TEST(Crypto, xtea_should_run_enc_dec)
{
    int i;
    unsigned int expected[4];

    for(i=0; i<4; i++)
        expected[i] = plan[i];

    xtea(key,plan,1,cipher);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    xtea(key,plan,0,cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, xtea_should_run_enc_dec_key_128)
{
    int i;
    unsigned int expected[4];
    unsigned int auxKey[4] = {
        0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF
    };

    for(i=0; i<4; i++)
        expected[i] = plan[i];

    xtea(auxKey,plan,1,cipher);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    xtea(auxKey,plan,0,cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, xtea_should_run_enc_dec_key_192)
{
    int i;
    unsigned int expected[4];
    unsigned int auxKey[6] = {
        0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF,
        0xFFFFFFFF, 0xFFFFFFFF
    };

    for(i=0; i<4; i++)
        expected[i] = plan[i];

    xtea(auxKey,plan,1,cipher);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    xtea(auxKey,plan,0,cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, xtea_should_run_enc_dec_key_256_plus)
{
    int i;
    unsigned int expected[4];
    unsigned int auxKey[10] = {
        0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF,
        0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF,
        0xFFFFFFFF, 0xFFFFFFFF
    };

    for(i=0; i<4; i++)
        expected[i] = plan[i];

    xtea(auxKey,plan,1,cipher);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    xtea(auxKey,plan,0,cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

//-----------------------------------------------------------------------------
// BLOWFISH INIT
//-----------------------------------------------------------------------------
TEST(Crypto, blowfish_init_should_setup_ctx_128)
{
    BLOWFISH_CTX ctx;
    unsigned int auxP[18] = {
        0xD05ED527, 0xB387F46A, 0xF27D2716, 0x4D96239D, 
        0xA917D911, 0x7FBD30E1, 0xC69A4AAF, 0xB37126BA,
        0x2D10CC63, 0x426762B8, 0xB360F4B3, 0x049BA48E,
        0x41225A67, 0xD740B824, 0x71A59E53, 0xDE08654C,
        0x4FA5CFD1, 0x7E6F46A4
    };
    unsigned int auxS[4][256] = {
        {
            0xB96280AA, 0x9C83F428, 0x9723AABF, 0xD97D524F, 
            0x373D60C5, 0xE8A8F8C4, 0xF737F34F, 0x6CCCCF89, 
            0x4B009111, 0x8A5DA4CC, 0xF1502804, 0xF4EEA5EA, 
            0xB105CABD, 0xA5ADDA54, 0x601A6237, 0x48D104E0, 
            0xDDC1EA98, 0x8F7BE962, 0x2A18AF6E, 0x7AC32F59, 
            0xF53DEE46, 0xDE790BDF, 0x0F55C70D, 0xCECFFE3D, 
            0xAA9A3F5F, 0x9150C381, 0x36765A13, 0x3EFF667C, 
            0x619D24DF, 0x1F368F3D, 0x3E233C25, 0x4D8678F1, 
            0x525EDA6F, 0xA75C2AF7, 0x91BC7B21, 0x87638352, 
            0x0C75C6DC, 0x4AC512B4, 0xE9608828, 0xBD9120EE, 
            0x350974D9, 0x2BFF84E9, 0xF6A9E9E3, 0x4116ACC3, 
            0x62EB033E, 0x63E6CED7, 0x80E569E8, 0x8000EF1A, 
            0xFA02CD0E, 0x2BBEC82F, 0x5E19F919, 0xABCD1AC5, 
            0x82F70B65, 0xD11581E8, 0xC885F7A2, 0x5EFF5E9F, 
            0xDBE5450A, 0xE94E9BAA, 0x8F656FB3, 0x8CF173B7, 
            0xB2B0206F, 0xDB2D0DDB, 0x34227285, 0x4995A86C, 
            0xD4F4CB09, 0xFE4B7616, 0x15FE56D6, 0x3C6A52C6, 
            0xE23500D8, 0x7F7C874B, 0x461783B7, 0xB5622511, 
            0xFE9AE1C4, 0x0396056B, 0xCD3DBC92, 0x00B8E329, 
            0xCE8BD607, 0xDEBE411A, 0x0C866D1B, 0xE72A6684, 
            0xEE79396C, 0xF5AFA5B5, 0x37225A4D, 0x95885F09, 
            0x018F4292, 0xE74782D2, 0x8E861F15, 0x62FAF35A, 
            0x4DEE2301, 0x8903E150, 0x82E7D644, 0x7D3B302B, 
            0x97A5D648, 0x28474F7B, 0x48EA6BA8, 0x041D85F4, 
            0x3E9C85FE, 0x93C55A1E, 0x603BC109, 0x98D50B56, 
            0x8CF0F82C, 0x4528EAD6, 0xC71355D3, 0x0CC76C09, 
            0xCF39A2F2, 0x3E812B8F, 0x1D084042, 0x2CAC4058, 
            0x4BF761D3, 0x3DD2E6F0, 0x4CFC73BF, 0x024BEFBD, 
            0x437E1BB2, 0x0A128ED9, 0x755F0E20, 0xB7CBBE7D, 
            0x1E252082, 0xA7B577CB, 0x7BE729FF, 0x26183714, 
            0xAFE58B40, 0xC194EC8B, 0xECE864E1, 0xC0F97457, 
            0x4C2F6807, 0x96E92A67, 0x5604C1E9, 0xEAC093D5, 
            0x92F960AC, 0x3638892D, 0x7AC43AB4, 0x1FB09125, 
            0x0F148E10, 0x8F2659F7, 0xE1F281BA, 0x59AFFFEE, 
            0xD98E8F90, 0xA002A643, 0xA5875DF7, 0xAB4FFFEB, 
            0x12E8C30F, 0x7B43580D, 0x3B2F413F, 0x1650CA88, 
            0x62C0F2CA, 0xFF97974F, 0x9403C583, 0x21210F44, 
            0x35B035D9, 0x42B2C710, 0xF6A4CC89, 0x55E1457B, 
            0x1D6CDE2B, 0x4B2FFC71, 0x48AC7F77, 0x24B01220, 
            0x886B2759, 0x24B1965C, 0x4A95A205, 0x56EFA766, 
            0xAD93A31F, 0x8120DFD0, 0xC83A7C48, 0x345498CD, 
            0x58F30511, 0x1397814E, 0xA4DA4994, 0x7476F266, 
            0x7738687E, 0x6AF267B5, 0x98BDA903, 0x87A4EEFF, 
            0x2E4D7E83, 0x1C860C87, 0xEEFC0C1E, 0x5FDE691E, 
            0xE578C4F9, 0xB9E39657, 0xD93CB064, 0x5CC99499, 
            0x738CE7C1, 0xFB7679FA, 0xF6B627DE, 0x51E88791, 
            0x609F1885, 0xDA278698, 0x64A16812, 0x6833083C, 
            0x6BEAB663, 0x4BEBAD8C, 0x96359773, 0x7A085D68, 
            0x5E5ECFCF, 0x7D6D3A8E, 0x8DA5268B, 0xC4C09CDE, 
            0x7E8285DF, 0x3AD02E6E, 0xD7363FCC, 0x3E8D1F68, 
            0x4492866C, 0x36E40142, 0x61937301, 0xFBD4D235, 
            0xCB80B61A, 0xD57A037D, 0x8B337B15, 0x96EAE56E, 
            0x561BFEAE, 0xCC7301A1, 0xD40C4206, 0x7A190D84, 
            0x8436F574, 0x72082D5E, 0xD5707106, 0x9A93F158, 
            0xAB143D08, 0x0D351340, 0xC60C8787, 0x87B639EC, 
            0xF5F6812D, 0x809C903A, 0xE8DD0494, 0x02014F19, 
            0xD00A5507, 0xD165BE2A, 0x6416385F, 0x88B95FE5, 
            0xF5DA4B8E, 0xE34B6156, 0x3D321226, 0xEE8FB27D, 
            0xC828A132, 0xF0864793, 0xD9C606EF, 0x428632BF, 
            0xAF3A90C1, 0xCE8CB4D0, 0x59857636, 0xC1FBA98A, 
            0xCEE41BAA, 0xE3F49B0C, 0x9939A0FD, 0xF06AB962, 
            0xED8D712D, 0x5C4B7417, 0x5EC9BD96, 0xFE07FBB6, 
            0x625516E1, 0x048269AC, 0xE0EA0E52, 0x03045FBD, 
            0x99516E44, 0x20C32BAB, 0x5810FF43, 0x37F06D42,
        },
        {
            0xD12A070A, 0xA660B4DE, 0xF2A1CCF9, 0x1D66D275, 
            0xFA495648, 0x1C4ED4E8, 0x30979B95, 0x54E48260, 
            0x9AAC069A, 0xD5B631A9, 0x74656733, 0xDD43F623, 
            0x964F48A0, 0xAD2CEDDB, 0xD9060A55, 0x799E3197, 
            0x330EA163, 0xC762D039, 0xE66B3A9A, 0xB111C4DE, 
            0x6150B0CB, 0x1E2D99E9, 0xB7166CC7, 0x8EDE80C9, 
            0xEA90D9E2, 0x16D9E65F, 0xFD473598, 0x015A3ABD, 
            0x9531BD11, 0x8418FE68, 0x9CD48AA6, 0x283B0E55, 
            0x9ED4ABA1, 0x95EA30E3, 0x43A27F20, 0x49A5DA6C, 
            0x7287CDD0, 0x74D69FAC, 0x0605F6E4, 0x55FFBE2D, 
            0x702E9ACF, 0x1BB957A2, 0x28830023, 0xCF35148F, 
            0xB0618B6C, 0x23CE9DCB, 0x2E2F0260, 0x6623987B, 
            0x8A7367E8, 0x8E364A52, 0xAB465221, 0x7EDE36BA, 
            0x93915728, 0x000C153B, 0xFA19E8AB, 0x27876233, 
            0xD172C4D6, 0xAF906E8A, 0x620F11B5, 0xAD139BED, 
            0x50A7AD01, 0xD6A7F5A8, 0x65AD683D, 0x0E825684, 
            0xA674036A, 0x7A1B1A94, 0x433CC1EB, 0x21063FF9, 
            0x716E8930, 0x8E812A0B, 0xA73B312F, 0xA581E576, 
            0x22ED7DFD, 0x7428253F, 0xFAAB8C5F, 0x6D9719FC, 
            0x1B38E23F, 0x73C4176B, 0x75341560, 0x95548909, 
            0x33CC0054, 0x930DF0DD, 0x7B0B0598, 0x2662FBEA, 
            0x90C6670D, 0x32C8E590, 0x99BDE667, 0xAB50F431, 
            0xA4CAFE90, 0x2BA2E258, 0x90A627C4, 0xDF0BABB5, 
            0x6E010AF7, 0x6AEE21A4, 0x195AE2CA, 0x80F5E3F7, 
            0x33C9FBEB, 0xB08F9BF2, 0x9A7AFBFD, 0x6793573D, 
            0x06027DFC, 0x5C948AF0, 0xB0338E69, 0xADB51B5F, 
            0x167836F9, 0x04211D74, 0x6E26D700, 0x6B6FA535, 
            0x712E39E9, 0x029A0484, 0x3FCA9F5D, 0xB9CB2EEB, 
            0x63D93343, 0x6C27D2FA, 0xBA30AD09, 0x6E53EED5, 
            0xF20746B6, 0xDB64A57D, 0x8C7E7A45, 0x4592CDEA, 
            0x3E1795A6, 0x1D980C11, 0xA3D65F9C, 0xB28B3E71, 
            0x838F0A38, 0x1D6755EA, 0x55EC159D, 0x45A30F3E, 
            0xF0A4D6EE, 0x70509590, 0xFD1717D6, 0xC76A3B2D, 
            0xD493A615, 0x91F555A9, 0x802ED79B, 0x86E187F0, 
            0xFE77E9DD, 0x90AFB7AE, 0x3945BDA8, 0xD3E37428, 
            0x9747A30C, 0xBD342AE3, 0xE5DCAB04, 0x40275B79, 
            0xFB6FB86C, 0xC6FF72E8, 0xA735D363, 0xCDDB08F2, 
            0x4098F61A, 0xAE339D78, 0x6ED90B27, 0x5F90ED89, 
            0xDDF3D806, 0x1568ABE6, 0x1FC57688, 0x672E7C31, 
            0xA14E8857, 0x51CA3386, 0x4D09A2AF, 0x1A1FBFE3, 
            0x4DF8CF8E, 0xB4DDB5B8, 0xA0104103, 0xD7E5D8DD, 
            0xB364E771, 0xE82CAD7E, 0x5878E085, 0xB5E3AF18, 
            0xBF3517DD, 0x7EBF45BD, 0xEB899BA4, 0x1B6D517E, 
            0x10C8B82C, 0xEB064B66, 0x82D566F8, 0x90EE27D4, 
            0x7C6479BD, 0xF28DF432, 0x52E8494C, 0xCE89144D, 
            0xA3FB795C, 0x05447C01, 0xFABE94BD, 0x7C25CB83, 
            0x9358A1E7, 0xECD82B87, 0xF0602D7E, 0xF2E43513, 
            0x58E0DB62, 0xF0C8276B, 0x7E3A5AB4, 0x4078B561, 
            0xF40BC8F7, 0xE42F6AEE, 0x8164EBBB, 0x27725340, 
            0x0E38559C, 0xD69BB996, 0x89E309BF, 0x785CDD65, 
            0x191170A9, 0x99569485, 0x65E6A5A4, 0xEC62CAF4, 
            0xE1F7482D, 0x38CE7F9C, 0xB8413426, 0x01F104E0, 
            0x08A575F0, 0x57724708, 0x069F3D3E, 0x2668C241, 
            0x05F3A57B, 0x8CD7A804, 0x75311BC9, 0xDC95EDCD, 
            0x711FFE10, 0x04CF9FE3, 0xFA07F9C3, 0xD0824697, 
            0x956B28E6, 0x2B695F16, 0xEE159A44, 0xBB5170A8, 
            0xC1ACC196, 0xB48CC1E8, 0x6DE6213C, 0x77E2552E, 
            0xF5056777, 0x955CDC56, 0x97B005DB, 0xE09FC901, 
            0x2319BA93, 0x241057B2, 0xD70DFB8E, 0x709DC2B3, 
            0x730BE4A0, 0x62BC71D6, 0xABFE0CAE, 0x9D4C3A17, 
            0xB6C2A1BF, 0x7F6F1013, 0x43475BBF, 0x8708C7C9, 
            0xD8F326BD, 0xB0A32CD7, 0x8A760A17, 0xD317C63B, 
            0x84335E63, 0xA937C2EC, 0x3ECC5557, 0x79610B38, 
            0x8DA8781A, 0xB5DCDE36, 0xB82DE4B9, 0x00785C59
        },
        {
            0xBF5AE857, 0xBDA8D576, 0xEE333120, 0x1A29FDE9, 
            0xDC24DB4C, 0xBFA57E94, 0xB7E8D4E3, 0xC1816BB1, 
            0x1C92EA1D, 0x95FDD7D6, 0x2321164B, 0x6992CA56, 
            0xDFB72D5B, 0x943DB510, 0xE0A398B0, 0xAF32AC84,
            0xB6AAA704, 0x5070AE54, 0x6B480FBF, 0x63CB067B, 
            0xBD055592, 0x49C44148, 0x763BAE92, 0xCCC6946A, 
            0x35A0A92D, 0x6F2D63AD, 0x27BF8B04, 0x43A50F44, 
            0x7C92E1D5, 0xC0EAEBCE, 0x71508149, 0x5054BD54, 
            0x75185CB7, 0x79C049D0, 0x921B459C, 0x53C11D52, 
            0x8F0C570E, 0x8ED5895D, 0x9479710A, 0x013CC9C2, 
            0xF122336A, 0x851B8214, 0x209BA361, 0xDA607067, 
            0x0E95EC3B, 0xE0D0F2D0, 0x40D90E84, 0xF50AE203, 
            0x372A6D08, 0x5D935429, 0xF7960712, 0x8FB7C6A4, 
            0x9946822D, 0x6EC1E889, 0x4B3A0D91, 0xEA92B3EB, 
            0x02A915BB, 0x0FAA8BE7, 0x32B4DE8F, 0x4DA14705, 
            0x445EDBF7, 0x0527C9F7, 0x1CE0CED5, 0x42BC2BC4, 
            0x5A0CECE9, 0xBF2980BB, 0x2D111CA2, 0x41F720A1, 
            0x82EAAFC9, 0x9F3C6867, 0xCA0FAEB0, 0x3D958FD9, 
            0xB6797A3B, 0x208D4C1B, 0x77BFA5CE, 0x02F7978D, 
            0x3C7BEBF9, 0x8C601E0D, 0xBE3BE004, 0xE2F1A904, 
            0x077CDEB0, 0xF5EDBA20, 0x0CB11CE6, 0x43F111B5, 
            0x0EF735D3, 0x0F480ED7, 0xCD720D35, 0xFF2BF093, 
            0xFA078D03, 0x30B21E74, 0x7CC5AC80, 0xEF2D6F73, 
            0xFCE89815, 0x15DE05A5, 0x640E331F, 0xCC25BC71, 
            0x872C44BC, 0x811FDAC1, 0x1F68B765, 0xFDF28D74, 
            0x5E65D9A2, 0xEE37701E, 0xA56A33A0, 0x78E674B6, 
            0x3FF71C80, 0x3D157751, 0x57B6E79F, 0xA7A90F15, 
            0x81EBAE19, 0x3BBD29F5, 0xF19B68E1, 0xE4D3D315, 
            0xEF4BE550, 0x4A0430F1, 0xE5BBF62F, 0xAC3B585D, 
            0x3FE3D3B9, 0x108BD3C9, 0xE6B72729, 0xE980B323, 
            0x23D7FF4A, 0x460D8D03, 0xF5F0DCE1, 0x39641714, 
            0xAA1DB81E, 0x80B6BE66, 0xA8CD1311, 0xC217883B, 
            0xE7DF6066, 0x41BCF7D3, 0x6C1A6AE9, 0x4C6DD0A6, 
            0x2A00926F, 0x18B693FC, 0xD849C0CA, 0x2DA0DA46, 
            0x36B9A552, 0x116D8C9E, 0x538FFF76, 0xC88B9635, 
            0x98F7D193, 0xFFF5488A, 0xF8EE04D6, 0x09570A39, 
            0x14618FF3, 0x196B7539, 0xD0B29661, 0x7884BEE5, 
            0xD33D638C, 0xC7D06371, 0x22793F88, 0xAC16E4F2, 
            0xB6F93896, 0x2CB119F8, 0x6DA2D6E8, 0x2753ABDB, 
            0x67EB3B25, 0x9EB14126, 0xC9BE26B8, 0xF99FB607, 
            0x6455F80E, 0xDD14DF31, 0x5F7A57F1, 0x149D59EA, 
            0xE2D37A1F, 0xACB83090, 0x5EE9949D, 0x6DC24DE7, 
            0x4EC727BC, 0x4A5FC15A, 0x55A0C6FC, 0x76A704A4, 
            0x8483E93F, 0x85E15C70, 0x07336032, 0xA6A25F4B, 
            0x4A06B33F, 0xF42EB26F, 0xA1761059, 0x31A0474C, 
            0x76855A3D, 0xE58F6263, 0xB0FD98BF, 0x5FE4C3F6, 
            0x613A89F9, 0x738645F3, 0xEEDA3E6D, 0xB705BD4B, 
            0x64ECEBB6, 0x49FE3CFF, 0xBC6ECB2E, 0x9C09812D, 
            0x770395D6, 0x05A703D9, 0xE8B53B29, 0x46B038A0, 
            0xB043BC8E, 0x7FF532D2, 0xF9C84F7E, 0xFB693AFA, 
            0x781D8C65, 0xD1377314, 0xA1D3DC79, 0x322B202A, 
            0x9FE7B688, 0x7BB0F4F4, 0x1FEBE72A, 0x04FA0E1D, 
            0x1AEDF076, 0x52961D23, 0x01CF0F06, 0xB2A6849E, 
            0xD36CF1D6, 0x4FB6A4B6, 0xD0F634AB, 0xB2A764B7, 
            0xF033B020, 0xF6D40C61, 0x00C31E7A, 0x2C3F8F16, 
            0xCDF46349, 0xA08917E5, 0x74E07FEB, 0x12F43124, 
            0xABCE5F8C, 0xE757B321, 0x983C4AB7, 0xE189DBA0, 
            0x22C64ED8, 0x2766A289, 0xCB144AE6, 0xA0ADEE0A, 
            0x79458CD4, 0x4A079F10, 0x645FC852, 0x232D4F23, 
            0xEBB45CB4, 0xBC641269, 0xB150AEB1, 0x2198B341, 
            0x3B70232E, 0xDAA7703D, 0xE0D7CA8B, 0x8A1D6994, 
            0x0DA951A4, 0x54CA330A, 0x5765830B, 0xFECEC571, 
            0x9C33399C, 0x7D5F0060, 0xEFC9BD5F, 0xBDEBD4AC, 
            0xD5E95FCB, 0x9E6020AF, 0xB76166B1, 0xC8BD2E6B
        },
        {
            0xDE7A876A, 0xE307E8A5, 0x10E08C98, 0xD4D0C9BC, 
            0x2B3D54E2, 0x4BA0F0A1, 0x6A6B1AE2, 0xFBBC9C1E, 
            0x6952B266, 0x6D9B763B, 0x74D66304, 0x21BA2BD7, 
            0x620EC570, 0x9B61B1D8, 0x8F2FACD4, 0x5BC9F6AC, 
            0x446A6D3D, 0x006BFCB6, 0x452C8B1E, 0x9FDEAC70, 
            0x8C4B7F4E, 0xFDDB86CF, 0xFE2E53DD, 0x0F4A3D2A, 
            0x0739111A, 0x120208DB, 0x7553185C, 0x5262F7AD,
            0xC95C9292, 0x8B2043A1, 0x52C75F13, 0x7DDD68AB, 
            0xCF896BC3, 0xC3112981, 0x4902DA2D, 0xAF7D844E, 
            0xDC825C26, 0x80130612, 0x70C5F4E0, 0xAC27EA6B, 
            0x3015B697, 0x5ADE02E8, 0x9BAA9615, 0xC5DA22BD, 
            0x67954A6B, 0x15822FA1, 0x502D2F92, 0xD6746958, 
            0x950A058C, 0x7A799BCB, 0x68A6A550, 0x6244070F, 
            0xBD2578DE, 0x624507DF, 0x1BD6CB27, 0xEC0F1536, 
            0x8EAA8367, 0x64BA471D, 0xD3A9B67A, 0xB67C47E6, 
            0x609B3CB4, 0x25A7C918, 0x2D965795, 0x105FADDE, 
            0xB7E69E7A, 0x5CBD87B3, 0x430B6079, 0x0AFD5FBF, 
            0x7BD5AFE8, 0xB58E4520, 0xA592DFED, 0x540E3DFF, 
            0xB6ACECD7, 0xC3058B4C, 0x213FD54D, 0x779EB523, 
            0x02CAEFE4, 0xACDF922C, 0xB9DB4AB4, 0xEFD86709, 
            0xF9DB6149, 0xB6640863, 0x68437F9E, 0x466DD8F1, 
            0xBC70D726, 0x6D007AFC, 0x073F57E1, 0x0E1C77D2, 
            0xA9AED740, 0x52CD05B6, 0xE6554FA0, 0x7C99E11C, 
            0x967BAA86, 0x7E332BDF, 0x0A2D7857, 0x5B6138B2, 
            0xA0469567, 0x08071989, 0x10159A92, 0x2926604F, 
            0x3CE35D45, 0x875548A2, 0x3743C4F8, 0x739D6A89, 
            0x24877F48, 0xA6D3A722, 0x06CA2747, 0x27773089, 
            0xE9840B7B, 0x7B0870E3, 0xC71D7251, 0xCD9C35F7, 
            0x2732580C, 0x5DAFCA36, 0xAA3407E2, 0x33C96316, 
            0x5ADA6964, 0x70682AB9, 0x410D5F43, 0x2A43E494, 
            0xCAE17789, 0xFA0A37B5, 0x125C3986, 0x2C35E5E6, 
            0x06853FAD, 0x9F2BE6C8, 0x1892C32B, 0x72330D8B, 
            0xF4873415, 0x44BC1729, 0x0484CA9B, 0xBE5C233A, 
            0x1AF66A07, 0xD1E1B42B, 0x314CFF4B, 0x86288346, 
            0xDB7A4340, 0xBD708C1B, 0xCD2B90CC, 0xC2A4EEB5, 
            0x48A4674F, 0xD91D2AF0, 0x574081AC, 0xCB0C35A2, 
            0xF3E774E5, 0x38545141, 0x71C30FDF, 0x8D734A1D, 
            0xFB319E73, 0x5E91B02E, 0x3930EC70, 0x8EAEB2F1, 
            0x8011B9A3, 0xCE45B39D, 0x24F3110B, 0x1B782E56, 
            0x52A73EF8, 0x2206C53B, 0x4ECB93AB, 0x74C24138, 
            0xFB0C87FA, 0x3E40AE6B, 0x9AB7BB34, 0x0362F2F0, 
            0x9F39D3EB, 0xABBEC808, 0x56C5206E, 0xA2563C3D, 
            0x1E61546D, 0x8BB7F554, 0x6D6F9D36, 0x1C411DDE, 
            0x909DBB91, 0xBBBEDEC7, 0x71BDAAA3, 0x03C6F17F, 
            0x2DC44F9C, 0x4BD0D060, 0xCD34725A, 0xF69E7525, 
            0xEA05B7E8, 0x72B79414, 0xC743099C, 0x713EE04A, 
            0x26DFE596, 0x7675BB63, 0x8F1E29F8, 0x4D86CCEF, 
            0xD916B87A, 0xE11A99CD, 0x13591E15, 0xFD07AA9D, 
            0xE45B8141, 0x8B2EE1FA, 0xC45B54B3, 0x748F5275, 
            0xC0464BC7, 0x89204FE5, 0xB8E26306, 0x18483B39, 
            0xC3DD4D54, 0xEC24A2D9, 0x13D9D118, 0x5D7B9573, 
            0x1EF5DF3F, 0x131E1D5C, 0x600ADA1A, 0x77D02602, 
            0x373FE08D, 0x0CFC01C2, 0x18F8DF70, 0x2AB1E54D, 
            0x32C8D8CC, 0xED729557, 0xE1763759, 0x3B728AD3, 
            0x7A4013E0, 0x6576AB80, 0x92C06264, 0x9ADDC7F9, 
            0xCD0B6262, 0xC25AD1DC, 0x1BB8933A, 0xC6EC7B83, 
            0xD8564FF9, 0x9507EF98, 0xDA64EA3A, 0xBAB5A3C3, 
            0x63170449, 0x08B68943, 0xFB216862, 0x8FD7D076, 
            0x35A660A5, 0xA8A79113, 0x2B056989, 0x8CE8E346, 
            0xAFAF4B10, 0x11029A34, 0xDBAB96AF, 0xD04C8F8A, 
            0x09E16462, 0x7E6458A9, 0xBA3BAA2D, 0xD0430D09, 
            0x4FE41BBB, 0x7BF5189F, 0x6AAD1D94, 0xA3AB4406, 
            0xC36803C4, 0x166D6AED, 0xB85450C5, 0x3264794E, 
            0xE39CADD8, 0x1689C696, 0x73D47522, 0xB025ED7A
        },
    };

    blowfish_init(&ctx, key, 4);

    TEST_ASSERT_EQUAL_UINT_ARRAY(auxP, ctx.P, 18);
    TEST_ASSERT_EQUAL_UINT_ARRAY(auxS[0], ctx.S[0], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(auxS[1], ctx.S[1], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(auxS[2], ctx.S[2], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(auxS[3], ctx.S[3], 256);
}

TEST(Crypto, blowfish_init_should_setup_ctx_192)
{
    BLOWFISH_CTX ctx;
    unsigned int auxP[18] = {
    0x68209558, 0xD4BE58EE, 0x776EFE18, 0xBB80E2AB, 
    0xAD261C1A, 0x58547EDE, 0x51BED131, 0xA6144272, 
    0x75393C22, 0x7E2C74C5, 0x24033B4B, 0xEDDF5AFE, 
    0xD2858B5B, 0xFD5E03B0, 0x8C7ABE1F, 0xF0459A0F, 
    0x92DD17A4, 0x86B2B779
    };
    unsigned int auxS[4][256] = {
        {
            0x13ADCF52, 0x201912D1, 0x9F8968B5, 0x96CF7136, 
            0x92D04B69, 0x8EF7F2EA, 0xBD4D44AC, 0x16097E05, 
            0xEAC447B2, 0x12A51B33, 0x526AF407, 0x648A0A8A, 
            0x477A719F, 0x33FE1E0B, 0xB356EAE5, 0xD113FF74, 
            0x29EFE351, 0xDF287D7A, 0x9E52488A, 0xB52C7FD2, 
            0xE0AD7DEF, 0x3F957427, 0x6AAC137E, 0x36D71C30, 
            0x35DBD325, 0x95927491, 0x13719E43, 0x017081D1, 
            0xBC1C83B4, 0x577709B1, 0xF2D6F97D, 0x5CCA0332, 
            0x97D18DF4, 0xB8E24F10, 0x25928669, 0xCE831F3D, 
            0x2D812DD1, 0x64DF4062, 0x11ABCAE2, 0xBD58BB16, 
            0x195A099A, 0xFBB9812F, 0x69940ABD, 0xEEA79E23, 
            0x8AC79B89, 0x7AB35874, 0x5B0A82D1, 0x92F3A05E, 
            0xF9683BC0, 0x274B8146, 0x66783C63, 0x3AEA178D, 
            0x9DDA7FAC, 0xE8F53327, 0x5FAB9F89, 0xB6E1E4AC, 
            0x274A95A9, 0xE6B5DD1E, 0x0D96A900, 0x1A0267B9, 
            0x5C70292F, 0x165ED216, 0x13181806, 0xC2E96442, 
            0xC6A60F77, 0xD85C703D, 0xD4D4860B, 0x63BED4CC, 
            0xAD834D6B, 0xDB419917, 0x7E482F26, 0x46AE9CFF, 
            0x242A6B90, 0x87A680DD, 0xAC58110E, 0xDA6F4360, 
            0x68937BB0, 0x5C96B181, 0xF4CD8073, 0xF9B5EA09, 
            0x4F07A3E1, 0x5D75E799, 0xFE8BBB41, 0xF2DC7E3F, 
            0x721DEB0F, 0x88C1DCE4, 0x0FBC84EA, 0xD97C69DA, 
            0x4613C0A7, 0x81422CD2, 0xE28B36FF, 0x192332A8, 
            0x55CA6A4D, 0x4BD0B55D, 0x81F42744, 0xDF6B8257, 
            0x01798E85, 0x948BDA8D, 0x70652CA3, 0x5A3CD347, 
            0xD02FF745, 0xBDE07DBE, 0x5AF8EAAD, 0xDB551D3A, 
            0xE714B335, 0xDD85B2A4, 0xFCB07EAF, 0xF9665BBA, 
            0x0A1EE6AC, 0xBDEF3F5E, 0x2A4887FD, 0x65BB1A0C, 
            0xBE031D01, 0x3CB4E589, 0xB1F07C1A, 0x49C58339, 
            0xB647818D, 0xDD21CC8D, 0xBDB5EE69, 0x2B7B79D3, 
            0x748C3CA6, 0x432DC314, 0xB319CB29, 0x9AB37FD9, 
            0x0335CBB2, 0x29A6E174, 0x2F65AB29, 0xB5C7D7D0, 
            0x7F26C9A3, 0x99E53318, 0x9DC4597A, 0xA18D9E9F, 
            0x00168385, 0x70499FDE, 0x1BB97E3D, 0x797AB72A, 
            0x13A76F09, 0x998663FD, 0xD13FEC26, 0x1DF613AC, 
            0x38EE4DC4, 0x9B487187, 0xC6ED3CB6, 0xB2170C7E, 
            0xB19DE5B5, 0x84038387, 0x3BD968E4, 0x311E0A0C, 
            0x2DC9F294, 0x4E55996C, 0xB771836F, 0x07203828, 
            0x04CC9B16, 0x05E7EF8E, 0xF543F579, 0x4A8CE542, 
            0xB8A80891, 0x5298C916, 0xABC2DEA1, 0xDA13C4FC, 
            0x901F059A, 0xD4E5DB85, 0x0955965B, 0x78A81456, 
            0x0F77C8B6, 0xC384070C, 0x44475909, 0x6D3FCF9E, 
            0xDC67032A, 0xB405622C, 0xF944C95C, 0x1710F7B5, 
            0x73B6BDD2, 0xC9DAE571, 0x4278BCC2, 0x03E3BBA1, 
            0x88DA0A06, 0x524F0E64, 0x5E0F17A6, 0x3F8191FD, 
            0xE7D3DCC5, 0x953D10B7, 0x52F960E2, 0x9D18C2D8, 
            0xB20BAF2D, 0x99153DFD, 0x9D69CEC8, 0x9DB66EC7, 
            0x95BBE90B, 0xC02CF7EF, 0x35D69B80, 0x014E25AF, 
            0x74B39B73, 0xF477CA80, 0x07551999, 0xBA34EB1E, 
            0x0DEF491B, 0x40C15FF4, 0x9D423571, 0xDA0A6626, 
            0xB0D469AD, 0x8B566942, 0x52BD1A50, 0x4E4856C5, 
            0xC0F63CBA, 0xB5680870, 0x94D29F52, 0xD17CB4AC, 
            0xA201B794, 0xEF3189C6, 0x853D2454, 0xBFC39B8B, 
            0xFA4B3F99, 0x71B443BC, 0x04935889, 0x7450C863, 
            0xB48FA3BA, 0x67F0A772, 0x0F5DFB73, 0x0443A530, 
            0xFE4DCAD4, 0xF334C1EB, 0x95B29B2C, 0xEB241D52, 
            0xE9D9637F, 0x1A3A1F97, 0xBC2E9397, 0x65954B8C, 
            0x5DBC5E5C, 0x4ACBBAAE, 0x012EF91D, 0xAD560476, 
            0xD87EC7FA, 0x3A558A47, 0xA14593F6, 0x9462CB86, 
            0xDCFAC996, 0xE5BAB7AD, 0x781E4D7D, 0xDA524081, 
            0x538FC0E9, 0x420D6BC1, 0x93C8B16E, 0x2CABDDFF, 
            0x1E7169EB, 0x47C4AEED, 0x8CFBE2B6, 0x78E8FE80, 
            0xF9FF956E, 0x3FA3473F, 0x1022AF48, 0x53AF7B9B, 
            0x56BE58D8, 0xF1243797, 0x18FCFA0B, 0xE16BD434
        },
        {
            0x52967289, 0x49ADDF8C, 0xDFC446FF, 0x887B7AA3, 
            0xBF4DC531, 0x248A7B74, 0x27CF50E1, 0xB16AD1E1, 
            0x4D663E36, 0x8A164DC1, 0x69BAFD96, 0x9CDB16AB, 
            0xC0D74540, 0x8CD07806, 0xC2A0C70C, 0xA2A92DC8, 
            0x3C184195, 0xE60C114E, 0xBF64885D, 0x6C839A4A, 
            0xE011CDFE, 0xACF10D1D, 0x74B8A7F1, 0xD8FAC40D, 
            0x5E059FA4, 0x84DD673E, 0x3C1A2150, 0x452BB3F2, 
            0x412237E9, 0xF950F135, 0xA1A25DDB, 0xEE38CDF8, 
            0x97DCFA83, 0x12B9B2C4, 0x8A9E1CCB, 0x447E921B, 
            0x48ED7B5C, 0xF8B1093F, 0x889F3728, 0xC73A8F82, 
            0x7633CE97, 0x1E2C5113, 0x642B69DC, 0xAB4653D9, 
            0x1F42A830, 0x8AE7D0CF, 0x55DAEC4D, 0xADCCE9FB, 
            0xD84F331C, 0x1EC861A3, 0x609F63C9, 0x5D49F6B9, 
            0xE66FD42C, 0xC4DF830F, 0x612EC69E, 0x74688A82, 
            0xED1C4BE5, 0xC8F44936, 0xF32077F0, 0x3A2AF26A, 
            0xD0AB82F4, 0xD5B96004, 0x042BAD97, 0xC2BFDE25, 
            0xBE4D9266, 0xC0393EF3, 0xC819F93E, 0x807CEE98, 
            0x2FAC9BA2, 0x9B8BE9A8, 0xD4481F19, 0x3701326A, 
            0x001A97C7, 0x1671CBDC, 0x127AA85A, 0x6D3C6CD3, 
            0x9FDC43E0, 0x33E6B00F, 0x73D06DFE, 0xEB3923F0, 
            0xDC6B8AAB, 0x621871CF, 0xE82515D1, 0x2A75EBE7, 
            0xDADFF1A2, 0x2C566894, 0x93220026, 0xD9DAFDD7, 
            0xB6DCA107, 0x1B63C7CB, 0x7ECF9FF0, 0x19370018, 
            0x38136855, 0x284951A0, 0x885E1332, 0xF725B0B1, 
            0x7EC71AB2, 0xD9BE97BD, 0x7320A910, 0xEE146BE0, 
            0xA9CF32C9, 0x2F6C5CCC, 0xD6339044, 0x14D5530E, 
            0x03B0C23C, 0x12787A92, 0x1CAA9498, 0x7C4584AF, 
            0x9795766A, 0x09C270B1, 0xA325C544, 0xDD47B2B4, 
            0x3BEB2930, 0x2CBCB647, 0x62C73E57, 0x49DAC824, 
            0x80B76904, 0x1F6FBEFF, 0x551AA478, 0xA88ECFA0, 
            0x772A5B48, 0xDA76777D, 0x746AE5FE, 0xF7630B61, 
            0xB68038E7, 0x14CD4954, 0xCC2F27B0, 0x4F417E0A, 
            0x4DF64A27, 0x368C21C1, 0xA1E7F5D5, 0x9BC8DA90, 
            0xB1F022F3, 0xB7523189, 0xB6D955A8, 0x2ABB3804, 
            0x2D7957AA, 0x31465033, 0x5B69C520, 0xB0F7CAF3, 
            0x202D921F, 0x6BB1CD25, 0x4AD48F2A, 0x127B1793, 
            0x0016F5E1, 0x1E15DBFF, 0x54EE3960, 0xECB61C57, 
            0x7A06AB1A, 0xDC620B4F, 0xA57634B2, 0x87C7A03F, 
            0x683D3385, 0xBFE818D9, 0x5A939A5B, 0xD1C404E5, 
            0xA654945C, 0xB4B65C23, 0x6DE97D8B, 0xF572C03E, 
            0x88339CBC, 0x8A40214F, 0xC0F1BC56, 0x8F39BFE7, 
            0xA7EFB42B, 0x03093291, 0x0A555138, 0x4D6C4F3B, 
            0x31478136, 0x629DA8A7, 0x8CBCA219, 0xC27EA0A7, 
            0x3808747A, 0xC376B1A0, 0x6E746A86, 0x79FC215D, 
            0xBC635270, 0x55BBF179, 0x39E3CC3C, 0x3B6BAB39, 
            0xA3AFD576, 0x22C49B39, 0x5063596E, 0xB376CD50, 
            0xE3E189AD, 0xACBF136C, 0x06ABB62B, 0xBB8DE067, 
            0xB3FD96C0, 0xF5053FC8, 0xA4AD066E, 0x0486CE90, 
            0xDBA720BA, 0x576A5814, 0x62313A95, 0x5E987D71, 
            0x01858D76, 0x453C2E9D, 0x85688806, 0x6450708E, 
            0xF0EEA75F, 0x0F33B839, 0x5CB8EFAD, 0xD377FC03, 
            0xD0B7DF6E, 0x0B98EA31, 0x524C525F, 0x908F1514, 
            0x874879BD, 0x8236909B, 0xC448C09F, 0x29D6D1A0, 
            0xFA005D01, 0x8B6E1690, 0x74481BA8, 0x97BEE745, 
            0x11B759F8, 0xFCBFA466, 0xA283C8E2, 0xD72F0605, 
            0x44598702, 0x63F96930, 0x3811FC39, 0x5739449E, 
            0x5DE7F61D, 0x0996A6A9, 0xE591872F, 0x0A894595, 
            0xE180805A, 0xB13631AB, 0x61C24214, 0x3C0D5AD6, 
            0xF89E236A, 0xB3021BDD, 0x4AF7BC53, 0x95F109D3, 
            0x9ABAB759, 0xA5BD2C1E, 0x3D099412, 0x8DFF0382, 
            0xB867818E, 0x3388114D, 0x03F00A98, 0xBBC8FDBB, 
            0xDCDC2EF5, 0xC29BBB78, 0x8BCBDE00, 0x693187A2, 
            0x91876282, 0x27562804, 0x93CDD092, 0x5FACB260, 
            0xECB85B11, 0x0038A65F, 0xCC70EE43, 0xC78C2430
        },
        {
            0x32A7D026, 0x845E2AA4, 0xF9D884A5, 0x5DC222D0, 
            0xD936E5EC, 0xB13D8882, 0x44372DE4, 0x05205E2B, 
            0x33D8FC2F, 0x361D0C01, 0xAA225BEC, 0x75190D39, 
            0xA9D14620, 0x49648FEC, 0x7A2BF2CD, 0x74271775, 
            0x611BCB51, 0xA41C89F2, 0x6D9EBBFA, 0x6CDC209E, 
            0x07D4F7E5, 0x897426A8, 0xAD16DEB3, 0x23C8160B, 
            0x4F34722D, 0xB2CD19A4, 0x025D9858, 0x7F823853, 
            0x03AB3615, 0xD6FD119F, 0x46874F1E, 0x129D0166, 
            0x9A6E186E, 0x53F20E59, 0x1A556E4C, 0x1EDE629E, 
            0x56FA138B, 0x11A6841D, 0xB488128C, 0x1E6929CE, 
            0xF2AE8CA5, 0xBB8DF0FA, 0x9FE2AD66, 0x9EBDCA9E, 
            0x3D500F47, 0x0A7726B3, 0x00BCC9E1, 0xC95F1C61, 
            0x1F53A213, 0xF4AF5C53, 0xA2CA0785, 0x2DA39402, 
            0x6DA3B957, 0x33A10C2B, 0xDA3F1549, 0x48208B2F, 
            0x020C2624, 0x8A6F493D, 0x9BB529B1, 0x0D95231C, 
            0x3866B576, 0x855E52E5, 0x892645DD, 0x3B1A2D32, 
            0x0823083A, 0x43F3E435, 0x8C98CB2D, 0xCDC89BF2, 
            0x49F976C8, 0xA1A8BE36, 0x776EF26E, 0xA289E9AD, 
            0x0DC470BD, 0x3A4146FB, 0x0E50CC4E, 0x6D933432, 
            0x42F7330A, 0x3BE613BF, 0x2DF67F6D, 0xB44A7ADA, 
            0xF0D10A22, 0x9371C0BB, 0x7CE47225, 0x95575CEC, 
            0xD628661B, 0x3D4CC949, 0x35C35BF9, 0x1002C6D5, 
            0xA4AA9423, 0xC498CAD0, 0xA1EA70AD, 0x7B177470, 
            0xFD2CEC99, 0x14660FE0, 0x16955607, 0xA660FCBA, 
            0x0D1603E6, 0x80B71633, 0xD5FFA12C, 0x56E90A60, 
            0x5DA1F44D, 0x13662766, 0x3FD26ED6, 0xF1D215EF, 
            0x3ABB0A03, 0x347066BD, 0x23C7EF8B, 0xC9F7A4D2, 
            0x788823F7, 0x3F6B7CC1, 0x6F4799E0, 0xAAEE854E, 
            0x425BFDC1, 0x47A1D246, 0x196BD7F8, 0x07EBD0A4, 
            0x5B43892E, 0x4DDC886F, 0xA21E776B, 0xA3510FCE, 
            0xDC94D781, 0xA5386AB6, 0xEDD2D4BD, 0x330C08E7, 
            0x999592F6, 0x77C34358, 0x24EB9191, 0x430CA07D, 
            0x874F206F, 0x1E0F4EF7, 0x21C3DC73, 0x09E93DAB, 
            0xD5E8FC08, 0xCBFD1D3D, 0x0E830919, 0xB5529C6F, 
            0xB48641B5, 0xFFAF5353, 0xB9EC9172, 0x5EC5CDBE, 
            0xB3928785, 0x26B9D1EA, 0x315244B5, 0xECDE3734, 
            0x4E30589E, 0x3B1645E4, 0x8761FAA3, 0xC8924449, 
            0xBAD9B29B, 0x65E788A7, 0xBB193615, 0x1431F7CE, 
            0x6BA7429E, 0xC183F476, 0x92C7C573, 0x0B90DD7B, 
            0x102B243E, 0xA0235E5C, 0x7D5A5CDF, 0xC2EB7C62, 
            0xAB6068FA, 0x787BD595, 0x3B0552FC, 0xCDE375A8, 
            0x578D97C2, 0x0BFB0772, 0x93DD5FBE, 0x99FE8F3A, 
            0x33232CE9, 0x77B701AD, 0x1CC261E2, 0x65EC54AE, 
            0x5E4111B9, 0x89E39929, 0x0E2B8C67, 0x6D5BF27A, 
            0x6847162C, 0x50B34AFB, 0x8DEBED87, 0x674D5F90, 
            0xF9CBCFCD, 0x37C7B457, 0x6BE42FBA, 0xECC50A5C, 
            0x7D8A8F66, 0x8CBE5D56, 0xD30D5B42, 0xC606C01D, 
            0x05687234, 0x7AB2B62F, 0x996C4393, 0x833108A2, 
            0x7B724DDD, 0x58CD4669, 0x62947055, 0x83C4D0C1, 
            0x000DD3A6, 0x18BC201F, 0xE60BCC1E, 0x7816FC91, 
            0x8C794965, 0x0552376C, 0xAE5BF923, 0x96F7C9D3, 
            0xF3262B14, 0xC6E54FA2, 0x8C6E8932, 0x2CC576A0, 
            0x6484E3B6, 0x9B0DFBE8, 0x1121F88B, 0x20392CE1, 
            0xE6069909, 0x6D4168B2, 0xBECC4544, 0xC446A822, 
            0xB361359E, 0xFE39EE0D, 0x81501A98, 0x4B3415A0, 
            0x07DB9F8B, 0xC2766D08, 0x3E88B1B9, 0x4A26E31C, 
            0x74D2E351, 0x917140F7, 0x271F65B0, 0x5A053F02, 
            0x138AB033, 0x39963C6E, 0xB94FF1EF, 0x31B52B1F, 
            0xF3B13B33, 0x4677A441, 0x2417AC74, 0x5A4FD813, 
            0xE4617069, 0x830D36F1, 0x225FC46A, 0x5B67BC36, 
            0xD8A44EBD, 0xC1DD8FFC, 0xA9A3EFA2, 0x653ED2D2, 
            0xCAC63AD6, 0x42D07C25, 0x214082AE, 0x5394D5B8, 
            0x0419C8F7, 0x3218E1AB, 0x8386040E, 0xCB6AD509, 
            0xF30FD5B3, 0x6ECF6751, 0x3DE52ECF, 0x5DCDA9FB
        },
        {
            0x4C563BE2, 0xC2565AF5, 0xDB3B1BC5, 0xC755C3F8, 
            0xBFDCF5EB, 0xAC73E145, 0x33128151, 0x787C1285, 
            0x1E9CB8F1, 0xE1305EEA, 0x22885305, 0x661C5E47, 
            0x697C241D, 0xA868D54B, 0xEB64F4C8, 0x6E707FCA, 
            0x57CECAF8, 0xF3C36447, 0x0F18208D, 0x022FC139, 
            0x53F92020, 0x3F5BB82B, 0xAF4DDAF3, 0x2B3A3542, 
            0xE72230E0, 0x76A73543, 0xF84DFD7F, 0x0A2EA0ED, 
            0x73AFA7E0, 0xA5DF1C7B, 0x458EAF77, 0xF57255D8, 
            0x0D980BAC, 0x96298E4E, 0xB75C6E6E, 0x2C3AD5BB, 
            0x824B6D38, 0x51C720E3, 0x39E022C9, 0xF434BDA8, 
            0x087A2383, 0x852F22AA, 0x3313C762, 0x62A28A77, 
            0x2262B516, 0x7D62F14C, 0x766E344D, 0xF34FA48B, 
            0x5A1A2A3A, 0x641A4AD0, 0x1AA4CF38, 0xCA05D696, 
            0x96FE962D, 0xBEC8BF2A, 0x948DDB01, 0x52956C2E, 
            0x64F6FCDC, 0x733AAA47, 0x2581E1F8, 0x3BB1B3B3, 
            0xA7BFDD15, 0xB5273FE2, 0x0BB034D5, 0xC66E5F60, 
            0x45D5EFCF, 0xC7F4693E, 0xEF8EBE7B, 0xEF48B85A, 
            0x16A7B9AD, 0x1057A75E, 0x5BFD9897, 0xEC76B84B, 
            0xD7FC6102, 0x94BB3C28, 0x70F71996, 0xD4EBE19A, 
            0x6CC71994, 0xA9F6F63B, 0x00BA8299, 0xE38E4BC9, 
            0x5236C2A3, 0xF14B8849, 0x674C06EC, 0xD512C96D, 
            0x94343E23, 0x14C826D7, 0x464808F4, 0xE3A63CE6, 
            0x133B7A37, 0x7B517E75, 0x739EC0AA, 0x369E6967, 
            0xCABF639E, 0xA82EA379, 0xEE2EEC47, 0x111E83C0, 
            0x7C3067ED, 0xCD6DB535, 0xBAF7B3DC, 0x5253DA82, 
            0xF5BF1249, 0x1139BDF2, 0xAF7EFF51, 0xA1C20984, 
            0x841D2CFE, 0x81E83B26, 0xE1E8F26D, 0x23A319EF, 
            0x1FCD3713, 0xDC4C63BA, 0x9B4DECFA, 0x86CFAEE7, 
            0x028012FC, 0x833846B1, 0x51F33410, 0x5DC09ABC, 
            0x1C999035, 0xBD1BA8F6, 0x50C34F46, 0x4A2F8E55, 
            0x3D577D18, 0x9B1D8F9A, 0xEC7767D4, 0xD2EC07B4, 
            0xC2E97CFD, 0xDA292C8E, 0x9AC21E0E, 0xA750D237, 
            0x2F29C610, 0x17D39A7E, 0xCE5ADA75, 0x0C040F43, 
            0x779EC928, 0x23F78721, 0xAEB19B1C, 0xED906B85, 
            0x2124FC48, 0xC0D18FC9, 0x01BBC164, 0xCF5382CF, 
            0x5808F5C8, 0x870A427E, 0xAD1608A4, 0x2CD68BB2, 
            0x6875203A, 0x6B2DC897, 0x5D2EA290, 0x04A81244, 
            0xBCF923A3, 0x43C308F3, 0xAAAD9E55, 0x80B23082, 
            0x0A6BA33E, 0x711F8325, 0xBDFE3AD0, 0xF00C924B, 
            0xCB879B0D, 0x46A3122D, 0x69589AB6, 0x86A7DE05, 
            0x99E5F1F5, 0xA44738B8, 0x96C99CC4, 0x12856438, 
            0x5F718004, 0xA6F4A80C, 0x4462E05A, 0x2E0A6BD9, 
            0x5D5C3576, 0x8EE80BC3, 0x8D8A6DC3, 0x70B63433, 
            0xA2325722, 0xD928F4D2, 0x491881F1, 0x135D59A1, 
            0xB2E38C71, 0xA186A93F, 0xC6610F85, 0xFAD8C118, 
            0x97DE9A04, 0x5B5C49A3, 0x947C957D, 0xE9B195F9, 
            0x31C01DFB, 0x933B9D24, 0x27AE7022, 0x5517E1E3, 
            0x1AA7E12F, 0xFFAEB467, 0x4FE4832E, 0xBDC2EA4A, 
            0xC879A2D4, 0x6C539046, 0xBEF0794E, 0xE6AD7217, 
            0xEAB8A075, 0x3A2173BB, 0x27193C1E, 0x6ED253B5, 
            0xBA441DC0, 0x5A4D28BA, 0xDA7373D8, 0xF3B5E455, 
            0xBD4EC495, 0x03586EC0, 0x59D25EB0, 0x869431EB, 
            0xC6D4017C, 0xB33916C7, 0xBD430F5F, 0x78619506, 
            0x830FC8A4, 0xB8F7193D, 0x012B2BEF, 0x20D1FBCA, 
            0xAB419C4F, 0x3E517C2C, 0x6C01CAEF, 0xBC4C3FED, 
            0x18E6A604, 0xE0D39363, 0x074231DF, 0x5F88A7E8, 
            0xD36A9DE8, 0xD75D384C, 0x35604232, 0xD7B65984, 
            0xAA018386, 0x2A2D982B, 0x6B41606C, 0xE3A3A2A2, 
            0xAFF9CA91, 0xA3A5D314, 0x6FEDC25D, 0xF3376A9C, 
            0xCE1A011D, 0x063A8427, 0x9D5B1729, 0x709324D6, 
            0x1426D97A, 0xDF71A3E4, 0x0C289A32, 0x086F2F68, 
            0xD9D84427, 0x106FAA3C, 0xC7727FD2, 0x035C55F9, 
            0x0786FE65, 0x72D07BC5, 0x185976A8, 0x938BEC38, 
            0xD43E924A, 0x24C94E38, 0x86EE9D69, 0xE36DF87A
        },
    };

    blowfish_init(&ctx, key, 6);

    TEST_ASSERT_EQUAL_UINT_ARRAY(auxP, ctx.P, 18);
    TEST_ASSERT_EQUAL_UINT_ARRAY(auxS[0], ctx.S[0], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(auxS[1], ctx.S[1], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(auxS[2], ctx.S[2], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(auxS[3], ctx.S[3], 256);
}

TEST(Crypto, blowfish_init_should_setup_ctx_256)
{
    BLOWFISH_CTX ctx;
    unsigned int auxP[18] = {
    0xD05ED527, 0xB387F46A, 0xF27D2716, 0x4D96239D, 
    0xA917D911, 0x7FBD30E1, 0xC69A4AAF, 0xB37126BA, 
    0x2D10CC63, 0x426762B8, 0xB360F4B3, 0x049BA48E, 
    0x41225A67, 0xD740B824, 0x71A59E53, 0xDE08654C, 
    0x4FA5CFD1, 0x7E6F46A4
    };
    unsigned int auxS[4][256] = {
        {
            0xB96280AA, 0x9C83F428, 0x9723AABF, 0xD97D524F, 
            0x373D60C5, 0xE8A8F8C4, 0xF737F34F, 0x6CCCCF89, 
            0x4B009111, 0x8A5DA4CC, 0xF1502804, 0xF4EEA5EA, 
            0xB105CABD, 0xA5ADDA54, 0x601A6237, 0x48D104E0, 
            0xDDC1EA98, 0x8F7BE962, 0x2A18AF6E, 0x7AC32F59, 
            0xF53DEE46, 0xDE790BDF, 0x0F55C70D, 0xCECFFE3D, 
            0xAA9A3F5F, 0x9150C381, 0x36765A13, 0x3EFF667C, 
            0x619D24DF, 0x1F368F3D, 0x3E233C25, 0x4D8678F1, 
            0x525EDA6F, 0xA75C2AF7, 0x91BC7B21, 0x87638352, 
            0x0C75C6DC, 0x4AC512B4, 0xE9608828, 0xBD9120EE, 
            0x350974D9, 0x2BFF84E9, 0xF6A9E9E3, 0x4116ACC3, 
            0x62EB033E, 0x63E6CED7, 0x80E569E8, 0x8000EF1A, 
            0xFA02CD0E, 0x2BBEC82F, 0x5E19F919, 0xABCD1AC5, 
            0x82F70B65, 0xD11581E8, 0xC885F7A2, 0x5EFF5E9F, 
            0xDBE5450A, 0xE94E9BAA, 0x8F656FB3, 0x8CF173B7, 
            0xB2B0206F, 0xDB2D0DDB, 0x34227285, 0x4995A86C, 
            0xD4F4CB09, 0xFE4B7616, 0x15FE56D6, 0x3C6A52C6, 
            0xE23500D8, 0x7F7C874B, 0x461783B7, 0xB5622511, 
            0xFE9AE1C4, 0x0396056B, 0xCD3DBC92, 0x00B8E329, 
            0xCE8BD607, 0xDEBE411A, 0x0C866D1B, 0xE72A6684, 
            0xEE79396C, 0xF5AFA5B5, 0x37225A4D, 0x95885F09, 
            0x018F4292, 0xE74782D2, 0x8E861F15, 0x62FAF35A, 
            0x4DEE2301, 0x8903E150, 0x82E7D644, 0x7D3B302B, 
            0x97A5D648, 0x28474F7B, 0x48EA6BA8, 0x041D85F4, 
            0x3E9C85FE, 0x93C55A1E, 0x603BC109, 0x98D50B56, 
            0x8CF0F82C, 0x4528EAD6, 0xC71355D3, 0x0CC76C09, 
            0xCF39A2F2, 0x3E812B8F, 0x1D084042, 0x2CAC4058, 
            0x4BF761D3, 0x3DD2E6F0, 0x4CFC73BF, 0x024BEFBD, 
            0x437E1BB2, 0x0A128ED9, 0x755F0E20, 0xB7CBBE7D, 
            0x1E252082, 0xA7B577CB, 0x7BE729FF, 0x26183714, 
            0xAFE58B40, 0xC194EC8B, 0xECE864E1, 0xC0F97457, 
            0x4C2F6807, 0x96E92A67, 0x5604C1E9, 0xEAC093D5, 
            0x92F960AC, 0x3638892D, 0x7AC43AB4, 0x1FB09125, 
            0x0F148E10, 0x8F2659F7, 0xE1F281BA, 0x59AFFFEE, 
            0xD98E8F90, 0xA002A643, 0xA5875DF7, 0xAB4FFFEB, 
            0x12E8C30F, 0x7B43580D, 0x3B2F413F, 0x1650CA88, 
            0x62C0F2CA, 0xFF97974F, 0x9403C583, 0x21210F44, 
            0x35B035D9, 0x42B2C710, 0xF6A4CC89, 0x55E1457B, 
            0x1D6CDE2B, 0x4B2FFC71, 0x48AC7F77, 0x24B01220, 
            0x886B2759, 0x24B1965C, 0x4A95A205, 0x56EFA766, 
            0xAD93A31F, 0x8120DFD0, 0xC83A7C48, 0x345498CD, 
            0x58F30511, 0x1397814E, 0xA4DA4994, 0x7476F266, 
            0x7738687E, 0x6AF267B5, 0x98BDA903, 0x87A4EEFF, 
            0x2E4D7E83, 0x1C860C87, 0xEEFC0C1E, 0x5FDE691E, 
            0xE578C4F9, 0xB9E39657, 0xD93CB064, 0x5CC99499, 
            0x738CE7C1, 0xFB7679FA, 0xF6B627DE, 0x51E88791, 
            0x609F1885, 0xDA278698, 0x64A16812, 0x6833083C, 
            0x6BEAB663, 0x4BEBAD8C, 0x96359773, 0x7A085D68, 
            0x5E5ECFCF, 0x7D6D3A8E, 0x8DA5268B, 0xC4C09CDE, 
            0x7E8285DF, 0x3AD02E6E, 0xD7363FCC, 0x3E8D1F68, 
            0x4492866C, 0x36E40142, 0x61937301, 0xFBD4D235, 
            0xCB80B61A, 0xD57A037D, 0x8B337B15, 0x96EAE56E, 
            0x561BFEAE, 0xCC7301A1, 0xD40C4206, 0x7A190D84, 
            0x8436F574, 0x72082D5E, 0xD5707106, 0x9A93F158, 
            0xAB143D08, 0x0D351340, 0xC60C8787, 0x87B639EC, 
            0xF5F6812D, 0x809C903A, 0xE8DD0494, 0x02014F19, 
            0xD00A5507, 0xD165BE2A, 0x6416385F, 0x88B95FE5, 
            0xF5DA4B8E, 0xE34B6156, 0x3D321226, 0xEE8FB27D, 
            0xC828A132, 0xF0864793, 0xD9C606EF, 0x428632BF, 
            0xAF3A90C1, 0xCE8CB4D0, 0x59857636, 0xC1FBA98A, 
            0xCEE41BAA, 0xE3F49B0C, 0x9939A0FD, 0xF06AB962, 
            0xED8D712D, 0x5C4B7417, 0x5EC9BD96, 0xFE07FBB6, 
            0x625516E1, 0x048269AC, 0xE0EA0E52, 0x03045FBD, 
            0x99516E44, 0x20C32BAB, 0x5810FF43, 0x37F06D42
        },
        {
            0xD12A070A, 0xA660B4DE, 0xF2A1CCF9, 0x1D66D275, 
            0xFA495648, 0x1C4ED4E8, 0x30979B95, 0x54E48260, 
            0x9AAC069A, 0xD5B631A9, 0x74656733, 0xDD43F623, 
            0x964F48A0, 0xAD2CEDDB, 0xD9060A55, 0x799E3197, 
            0x330EA163, 0xC762D039, 0xE66B3A9A, 0xB111C4DE, 
            0x6150B0CB, 0x1E2D99E9, 0xB7166CC7, 0x8EDE80C9, 
            0xEA90D9E2, 0x16D9E65F, 0xFD473598, 0x015A3ABD, 
            0x9531BD11, 0x8418FE68, 0x9CD48AA6, 0x283B0E55, 
            0x9ED4ABA1, 0x95EA30E3, 0x43A27F20, 0x49A5DA6C, 
            0x7287CDD0, 0x74D69FAC, 0x0605F6E4, 0x55FFBE2D, 
            0x702E9ACF, 0x1BB957A2, 0x28830023, 0xCF35148F, 
            0xB0618B6C, 0x23CE9DCB, 0x2E2F0260, 0x6623987B, 
            0x8A7367E8, 0x8E364A52, 0xAB465221, 0x7EDE36BA, 
            0x93915728, 0x000C153B, 0xFA19E8AB, 0x27876233, 
            0xD172C4D6, 0xAF906E8A, 0x620F11B5, 0xAD139BED, 
            0x50A7AD01, 0xD6A7F5A8, 0x65AD683D, 0x0E825684, 
            0xA674036A, 0x7A1B1A94, 0x433CC1EB, 0x21063FF9, 
            0x716E8930, 0x8E812A0B, 0xA73B312F, 0xA581E576, 
            0x22ED7DFD, 0x7428253F, 0xFAAB8C5F, 0x6D9719FC, 
            0x1B38E23F, 0x73C4176B, 0x75341560, 0x95548909, 
            0x33CC0054, 0x930DF0DD, 0x7B0B0598, 0x2662FBEA, 
            0x90C6670D, 0x32C8E590, 0x99BDE667, 0xAB50F431, 
            0xA4CAFE90, 0x2BA2E258, 0x90A627C4, 0xDF0BABB5, 
            0x6E010AF7, 0x6AEE21A4, 0x195AE2CA, 0x80F5E3F7, 
            0x33C9FBEB, 0xB08F9BF2, 0x9A7AFBFD, 0x6793573D, 
            0x06027DFC, 0x5C948AF0, 0xB0338E69, 0xADB51B5F, 
            0x167836F9, 0x04211D74, 0x6E26D700, 0x6B6FA535, 
            0x712E39E9, 0x029A0484, 0x3FCA9F5D, 0xB9CB2EEB, 
            0x63D93343, 0x6C27D2FA, 0xBA30AD09, 0x6E53EED5, 
            0xF20746B6, 0xDB64A57D, 0x8C7E7A45, 0x4592CDEA, 
            0x3E1795A6, 0x1D980C11, 0xA3D65F9C, 0xB28B3E71, 
            0x838F0A38, 0x1D6755EA, 0x55EC159D, 0x45A30F3E, 
            0xF0A4D6EE, 0x70509590, 0xFD1717D6, 0xC76A3B2D, 
            0xD493A615, 0x91F555A9, 0x802ED79B, 0x86E187F0, 
            0xFE77E9DD, 0x90AFB7AE, 0x3945BDA8, 0xD3E37428, 
            0x9747A30C, 0xBD342AE3, 0xE5DCAB04, 0x40275B79, 
            0xFB6FB86C, 0xC6FF72E8, 0xA735D363, 0xCDDB08F2, 
            0x4098F61A, 0xAE339D78, 0x6ED90B27, 0x5F90ED89, 
            0xDDF3D806, 0x1568ABE6, 0x1FC57688, 0x672E7C31, 
            0xA14E8857, 0x51CA3386, 0x4D09A2AF, 0x1A1FBFE3, 
            0x4DF8CF8E, 0xB4DDB5B8, 0xA0104103, 0xD7E5D8DD, 
            0xB364E771, 0xE82CAD7E, 0x5878E085, 0xB5E3AF18, 
            0xBF3517DD, 0x7EBF45BD, 0xEB899BA4, 0x1B6D517E, 
            0x10C8B82C, 0xEB064B66, 0x82D566F8, 0x90EE27D4, 
            0x7C6479BD, 0xF28DF432, 0x52E8494C, 0xCE89144D, 
            0xA3FB795C, 0x05447C01, 0xFABE94BD, 0x7C25CB83, 
            0x9358A1E7, 0xECD82B87, 0xF0602D7E, 0xF2E43513, 
            0x58E0DB62, 0xF0C8276B, 0x7E3A5AB4, 0x4078B561, 
            0xF40BC8F7, 0xE42F6AEE, 0x8164EBBB, 0x27725340, 
            0x0E38559C, 0xD69BB996, 0x89E309BF, 0x785CDD65, 
            0x191170A9, 0x99569485, 0x65E6A5A4, 0xEC62CAF4, 
            0xE1F7482D, 0x38CE7F9C, 0xB8413426, 0x01F104E0, 
            0x08A575F0, 0x57724708, 0x069F3D3E, 0x2668C241, 
            0x05F3A57B, 0x8CD7A804, 0x75311BC9, 0xDC95EDCD, 
            0x711FFE10, 0x04CF9FE3, 0xFA07F9C3, 0xD0824697, 
            0x956B28E6, 0x2B695F16, 0xEE159A44, 0xBB5170A8, 
            0xC1ACC196, 0xB48CC1E8, 0x6DE6213C, 0x77E2552E, 
            0xF5056777, 0x955CDC56, 0x97B005DB, 0xE09FC901, 
            0x2319BA93, 0x241057B2, 0xD70DFB8E, 0x709DC2B3, 
            0x730BE4A0, 0x62BC71D6, 0xABFE0CAE, 0x9D4C3A17, 
            0xB6C2A1BF, 0x7F6F1013, 0x43475BBF, 0x8708C7C9, 
            0xD8F326BD, 0xB0A32CD7, 0x8A760A17, 0xD317C63B, 
            0x84335E63, 0xA937C2EC, 0x3ECC5557, 0x79610B38, 
            0x8DA8781A, 0xB5DCDE36, 0xB82DE4B9, 0x00785C59
        },
        {
            0xBF5AE857, 0xBDA8D576, 0xEE333120, 0x1A29FDE9, 
            0xDC24DB4C, 0xBFA57E94, 0xB7E8D4E3, 0xC1816BB1, 
            0x1C92EA1D, 0x95FDD7D6, 0x2321164B, 0x6992CA56, 
            0xDFB72D5B, 0x943DB510, 0xE0A398B0, 0xAF32AC84, 
            0xB6AAA704, 0x5070AE54, 0x6B480FBF, 0x63CB067B, 
            0xBD055592, 0x49C44148, 0x763BAE92, 0xCCC6946A, 
            0x35A0A92D, 0x6F2D63AD, 0x27BF8B04, 0x43A50F44, 
            0x7C92E1D5, 0xC0EAEBCE, 0x71508149, 0x5054BD54, 
            0x75185CB7, 0x79C049D0, 0x921B459C, 0x53C11D52, 
            0x8F0C570E, 0x8ED5895D, 0x9479710A, 0x013CC9C2, 
            0xF122336A, 0x851B8214, 0x209BA361, 0xDA607067, 
            0x0E95EC3B, 0xE0D0F2D0, 0x40D90E84, 0xF50AE203, 
            0x372A6D08, 0x5D935429, 0xF7960712, 0x8FB7C6A4, 
            0x9946822D, 0x6EC1E889, 0x4B3A0D91, 0xEA92B3EB, 
            0x02A915BB, 0x0FAA8BE7, 0x32B4DE8F, 0x4DA14705, 
            0x445EDBF7, 0x0527C9F7, 0x1CE0CED5, 0x42BC2BC4, 
            0x5A0CECE9, 0xBF2980BB, 0x2D111CA2, 0x41F720A1, 
            0x82EAAFC9, 0x9F3C6867, 0xCA0FAEB0, 0x3D958FD9, 
            0xB6797A3B, 0x208D4C1B, 0x77BFA5CE, 0x02F7978D, 
            0x3C7BEBF9, 0x8C601E0D, 0xBE3BE004, 0xE2F1A904, 
            0x077CDEB0, 0xF5EDBA20, 0x0CB11CE6, 0x43F111B5, 
            0x0EF735D3, 0x0F480ED7, 0xCD720D35, 0xFF2BF093, 
            0xFA078D03, 0x30B21E74, 0x7CC5AC80, 0xEF2D6F73, 
            0xFCE89815, 0x15DE05A5, 0x640E331F, 0xCC25BC71, 
            0x872C44BC, 0x811FDAC1, 0x1F68B765, 0xFDF28D74, 
            0x5E65D9A2, 0xEE37701E, 0xA56A33A0, 0x78E674B6, 
            0x3FF71C80, 0x3D157751, 0x57B6E79F, 0xA7A90F15, 
            0x81EBAE19, 0x3BBD29F5, 0xF19B68E1, 0xE4D3D315, 
            0xEF4BE550, 0x4A0430F1, 0xE5BBF62F, 0xAC3B585D, 
            0x3FE3D3B9, 0x108BD3C9, 0xE6B72729, 0xE980B323, 
            0x23D7FF4A, 0x460D8D03, 0xF5F0DCE1, 0x39641714, 
            0xAA1DB81E, 0x80B6BE66, 0xA8CD1311, 0xC217883B, 
            0xE7DF6066, 0x41BCF7D3, 0x6C1A6AE9, 0x4C6DD0A6, 
            0x2A00926F, 0x18B693FC, 0xD849C0CA, 0x2DA0DA46, 
            0x36B9A552, 0x116D8C9E, 0x538FFF76, 0xC88B9635, 
            0x98F7D193, 0xFFF5488A, 0xF8EE04D6, 0x09570A39, 
            0x14618FF3, 0x196B7539, 0xD0B29661, 0x7884BEE5, 
            0xD33D638C, 0xC7D06371, 0x22793F88, 0xAC16E4F2, 
            0xB6F93896, 0x2CB119F8, 0x6DA2D6E8, 0x2753ABDB, 
            0x67EB3B25, 0x9EB14126, 0xC9BE26B8, 0xF99FB607, 
            0x6455F80E, 0xDD14DF31, 0x5F7A57F1, 0x149D59EA, 
            0xE2D37A1F, 0xACB83090, 0x5EE9949D, 0x6DC24DE7, 
            0x4EC727BC, 0x4A5FC15A, 0x55A0C6FC, 0x76A704A4, 
            0x8483E93F, 0x85E15C70, 0x07336032, 0xA6A25F4B, 
            0x4A06B33F, 0xF42EB26F, 0xA1761059, 0x31A0474C, 
            0x76855A3D, 0xE58F6263, 0xB0FD98BF, 0x5FE4C3F6, 
            0x613A89F9, 0x738645F3, 0xEEDA3E6D, 0xB705BD4B, 
            0x64ECEBB6, 0x49FE3CFF, 0xBC6ECB2E, 0x9C09812D, 
            0x770395D6, 0x05A703D9, 0xE8B53B29, 0x46B038A0, 
            0xB043BC8E, 0x7FF532D2, 0xF9C84F7E, 0xFB693AFA, 
            0x781D8C65, 0xD1377314, 0xA1D3DC79, 0x322B202A, 
            0x9FE7B688, 0x7BB0F4F4, 0x1FEBE72A, 0x04FA0E1D, 
            0x1AEDF076, 0x52961D23, 0x01CF0F06, 0xB2A6849E, 
            0xD36CF1D6, 0x4FB6A4B6, 0xD0F634AB, 0xB2A764B7, 
            0xF033B020, 0xF6D40C61, 0x00C31E7A, 0x2C3F8F16, 
            0xCDF46349, 0xA08917E5, 0x74E07FEB, 0x12F43124, 
            0xABCE5F8C, 0xE757B321, 0x983C4AB7, 0xE189DBA0, 
            0x22C64ED8, 0x2766A289, 0xCB144AE6, 0xA0ADEE0A, 
            0x79458CD4, 0x4A079F10, 0x645FC852, 0x232D4F23, 
            0xEBB45CB4, 0xBC641269, 0xB150AEB1, 0x2198B341, 
            0x3B70232E, 0xDAA7703D, 0xE0D7CA8B, 0x8A1D6994, 
            0x0DA951A4, 0x54CA330A, 0x5765830B, 0xFECEC571, 
            0x9C33399C, 0x7D5F0060, 0xEFC9BD5F, 0xBDEBD4AC, 
            0xD5E95FCB, 0x9E6020AF, 0xB76166B1, 0xC8BD2E6B
        },
        {
            0xDE7A876A, 0xE307E8A5, 0x10E08C98, 0xD4D0C9BC, 
            0x2B3D54E2, 0x4BA0F0A1, 0x6A6B1AE2, 0xFBBC9C1E, 
            0x6952B266, 0x6D9B763B, 0x74D66304, 0x21BA2BD7, 
            0x620EC570, 0x9B61B1D8, 0x8F2FACD4, 0x5BC9F6AC, 
            0x446A6D3D, 0x006BFCB6, 0x452C8B1E, 0x9FDEAC70, 
            0x8C4B7F4E, 0xFDDB86CF, 0xFE2E53DD, 0x0F4A3D2A, 
            0x0739111A, 0x120208DB, 0x7553185C, 0x5262F7AD, 
            0xC95C9292, 0x8B2043A1, 0x52C75F13, 0x7DDD68AB, 
            0xCF896BC3, 0xC3112981, 0x4902DA2D, 0xAF7D844E, 
            0xDC825C26, 0x80130612, 0x70C5F4E0, 0xAC27EA6B, 
            0x3015B697, 0x5ADE02E8, 0x9BAA9615, 0xC5DA22BD, 
            0x67954A6B, 0x15822FA1, 0x502D2F92, 0xD6746958, 
            0x950A058C, 0x7A799BCB, 0x68A6A550, 0x6244070F, 
            0xBD2578DE, 0x624507DF, 0x1BD6CB27, 0xEC0F1536, 
            0x8EAA8367, 0x64BA471D, 0xD3A9B67A, 0xB67C47E6, 
            0x609B3CB4, 0x25A7C918, 0x2D965795, 0x105FADDE, 
            0xB7E69E7A, 0x5CBD87B3, 0x430B6079, 0x0AFD5FBF, 
            0x7BD5AFE8, 0xB58E4520, 0xA592DFED, 0x540E3DFF, 
            0xB6ACECD7, 0xC3058B4C, 0x213FD54D, 0x779EB523, 
            0x02CAEFE4, 0xACDF922C, 0xB9DB4AB4, 0xEFD86709, 
            0xF9DB6149, 0xB6640863, 0x68437F9E, 0x466DD8F1, 
            0xBC70D726, 0x6D007AFC, 0x073F57E1, 0x0E1C77D2, 
            0xA9AED740, 0x52CD05B6, 0xE6554FA0, 0x7C99E11C, 
            0x967BAA86, 0x7E332BDF, 0x0A2D7857, 0x5B6138B2, 
            0xA0469567, 0x08071989, 0x10159A92, 0x2926604F, 
            0x3CE35D45, 0x875548A2, 0x3743C4F8, 0x739D6A89, 
            0x24877F48, 0xA6D3A722, 0x06CA2747, 0x27773089, 
            0xE9840B7B, 0x7B0870E3, 0xC71D7251, 0xCD9C35F7, 
            0x2732580C, 0x5DAFCA36, 0xAA3407E2, 0x33C96316, 
            0x5ADA6964, 0x70682AB9, 0x410D5F43, 0x2A43E494, 
            0xCAE17789, 0xFA0A37B5, 0x125C3986, 0x2C35E5E6, 
            0x06853FAD, 0x9F2BE6C8, 0x1892C32B, 0x72330D8B, 
            0xF4873415, 0x44BC1729, 0x0484CA9B, 0xBE5C233A, 
            0x1AF66A07, 0xD1E1B42B, 0x314CFF4B, 0x86288346, 
            0xDB7A4340, 0xBD708C1B, 0xCD2B90CC, 0xC2A4EEB5, 
            0x48A4674F, 0xD91D2AF0, 0x574081AC, 0xCB0C35A2, 
            0xF3E774E5, 0x38545141, 0x71C30FDF, 0x8D734A1D, 
            0xFB319E73, 0x5E91B02E, 0x3930EC70, 0x8EAEB2F1, 
            0x8011B9A3, 0xCE45B39D, 0x24F3110B, 0x1B782E56, 
            0x52A73EF8, 0x2206C53B, 0x4ECB93AB, 0x74C24138, 
            0xFB0C87FA, 0x3E40AE6B, 0x9AB7BB34, 0x0362F2F0, 
            0x9F39D3EB, 0xABBEC808, 0x56C5206E, 0xA2563C3D, 
            0x1E61546D, 0x8BB7F554, 0x6D6F9D36, 0x1C411DDE, 
            0x909DBB91, 0xBBBEDEC7, 0x71BDAAA3, 0x03C6F17F, 
            0x2DC44F9C, 0x4BD0D060, 0xCD34725A, 0xF69E7525, 
            0xEA05B7E8, 0x72B79414, 0xC743099C, 0x713EE04A, 
            0x26DFE596, 0x7675BB63, 0x8F1E29F8, 0x4D86CCEF, 
            0xD916B87A, 0xE11A99CD, 0x13591E15, 0xFD07AA9D, 
            0xE45B8141, 0x8B2EE1FA, 0xC45B54B3, 0x748F5275, 
            0xC0464BC7, 0x89204FE5, 0xB8E26306, 0x18483B39, 
            0xC3DD4D54, 0xEC24A2D9, 0x13D9D118, 0x5D7B9573, 
            0x1EF5DF3F, 0x131E1D5C, 0x600ADA1A, 0x77D02602, 
            0x373FE08D, 0x0CFC01C2, 0x18F8DF70, 0x2AB1E54D, 
            0x32C8D8CC, 0xED729557, 0xE1763759, 0x3B728AD3, 
            0x7A4013E0, 0x6576AB80, 0x92C06264, 0x9ADDC7F9, 
            0xCD0B6262, 0xC25AD1DC, 0x1BB8933A, 0xC6EC7B83, 
            0xD8564FF9, 0x9507EF98, 0xDA64EA3A, 0xBAB5A3C3, 
            0x63170449, 0x08B68943, 0xFB216862, 0x8FD7D076, 
            0x35A660A5, 0xA8A79113, 0x2B056989, 0x8CE8E346, 
            0xAFAF4B10, 0x11029A34, 0xDBAB96AF, 0xD04C8F8A, 
            0x09E16462, 0x7E6458A9, 0xBA3BAA2D, 0xD0430D09, 
            0x4FE41BBB, 0x7BF5189F, 0x6AAD1D94, 0xA3AB4406, 
            0xC36803C4, 0x166D6AED, 0xB85450C5, 0x3264794E, 
            0xE39CADD8, 0x1689C696, 0x73D47522, 0xB025ED7A
        },
    };

    blowfish_init(&ctx, key, 8);

    TEST_ASSERT_EQUAL_UINT_ARRAY(auxP, ctx.P, 18);
    TEST_ASSERT_EQUAL_UINT_ARRAY(auxS[0], ctx.S[0], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(auxS[1], ctx.S[1], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(auxS[2], ctx.S[2], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(auxS[3], ctx.S[3], 256);
}

//-----------------------------------------------------------------------------
// BLOWFISH F
//-----------------------------------------------------------------------------
TEST(Crypto, blowfish_f_all)
{
    int i, j;
    unsigned int auxS[4] = {
        0xfa92d467, 0x84804db4, 0x9ab247c1, 0xddddcdab
    };
    unsigned int auxP[18] = {
        0xfa92d467, 0x84804db4, 0x9ab247c1, 0xddddcdab, 
        0x7aa486cd, 0x28bc74b7, 0x81853777, 0x32e3d266, 
        0x9b859f09, 0x39f35610, 0x37ffab20, 0xea44b283, 
        0x1e019758, 0xc85f15ba, 0xb62f185a, 0x6beab7f8, 
        0x4cbb6b36, 0x885abe7c
    };
    BLOWFISH_CTX ctx;
    unsigned int Xl;

    for(i = 0; i < 18; i++) {
        ctx.P[i] = auxP[i];
    }

    for (i = 0; i < 4; ++i) {
        for (j = 0; j < 256; j++) {
            ctx.S[i][j] = auxS[i];
        }
    }

    Xl = Xl ^ ctx.P[0];

    TEST_ASSERT_EQUAL_UINT(0xc37f3385, F(&ctx, Xl));
}

//-----------------------------------------------------------------------------
// BLOWFISH ENC
//-----------------------------------------------------------------------------
TEST(Crypto, blowfish_enc_any)
{
    int i, j;
    unsigned int auxS[4] = {
        0xfa92d467, 0x84804db4, 0x9ab247c1, 0xddddcdab
    };
    unsigned int auxP[18] = {
        0xfa92d467, 0x84804db4, 0x9ab247c1, 0xddddcdab, 
        0x7aa486cd, 0x28bc74b7, 0x81853777, 0x32e3d266, 
        0x9b859f09, 0x39f35610, 0x37ffab20, 0xea44b283, 
        0x1e019758, 0xc85f15ba, 0xb62f185a, 0x6beab7f8, 
        0x4cbb6b36, 0x885abe7c
    };
    unsigned int datal = 0x00000000, datar = 0x00000000;
    BLOWFISH_CTX ctx;

    for(i = 0; i < 18; i++) {
        ctx.P[i] = auxP[i];
    }

    for (i = 0; i < 4; ++i) {
        for (j = 0; j < 256; j++) {
            ctx.S[i][j] = auxS[i];
        }
    }
    
    blowfish_enc(&ctx, &datal, &datar);

    TEST_ASSERT_EQUAL_UINT(0xbb5ade63, datal);
    TEST_ASSERT_EQUAL_UINT(0xd3eef201, datar);
}

TEST(Crypto, blowfish_enc_128_multiple)
{
    int i, j;
    unsigned int expectedP[18] = {
        0xD05ED527, 0xB387F46A, 0xF27D2716, 0x4D96239D, 
        0xA917D911, 0x7FBD30E1, 0xC69A4AAF, 0xB37126BA,
        0x2D10CC63, 0x426762B8, 0xB360F4B3, 0x049BA48E,
        0x41225A67, 0xD740B824, 0x71A59E53, 0xDE08654C,
        0x4FA5CFD1, 0x7E6F46A4
    };
    unsigned int expectedS[4][256] = {
        {
            0xB96280AA, 0x9C83F428, 0x9723AABF, 0xD97D524F, 
            0x373D60C5, 0xE8A8F8C4, 0xF737F34F, 0x6CCCCF89, 
            0x4B009111, 0x8A5DA4CC, 0xF1502804, 0xF4EEA5EA, 
            0xB105CABD, 0xA5ADDA54, 0x601A6237, 0x48D104E0, 
            0xDDC1EA98, 0x8F7BE962, 0x2A18AF6E, 0x7AC32F59, 
            0xF53DEE46, 0xDE790BDF, 0x0F55C70D, 0xCECFFE3D, 
            0xAA9A3F5F, 0x9150C381, 0x36765A13, 0x3EFF667C, 
            0x619D24DF, 0x1F368F3D, 0x3E233C25, 0x4D8678F1, 
            0x525EDA6F, 0xA75C2AF7, 0x91BC7B21, 0x87638352, 
            0x0C75C6DC, 0x4AC512B4, 0xE9608828, 0xBD9120EE, 
            0x350974D9, 0x2BFF84E9, 0xF6A9E9E3, 0x4116ACC3, 
            0x62EB033E, 0x63E6CED7, 0x80E569E8, 0x8000EF1A, 
            0xFA02CD0E, 0x2BBEC82F, 0x5E19F919, 0xABCD1AC5, 
            0x82F70B65, 0xD11581E8, 0xC885F7A2, 0x5EFF5E9F, 
            0xDBE5450A, 0xE94E9BAA, 0x8F656FB3, 0x8CF173B7, 
            0xB2B0206F, 0xDB2D0DDB, 0x34227285, 0x4995A86C, 
            0xD4F4CB09, 0xFE4B7616, 0x15FE56D6, 0x3C6A52C6, 
            0xE23500D8, 0x7F7C874B, 0x461783B7, 0xB5622511, 
            0xFE9AE1C4, 0x0396056B, 0xCD3DBC92, 0x00B8E329, 
            0xCE8BD607, 0xDEBE411A, 0x0C866D1B, 0xE72A6684, 
            0xEE79396C, 0xF5AFA5B5, 0x37225A4D, 0x95885F09, 
            0x018F4292, 0xE74782D2, 0x8E861F15, 0x62FAF35A, 
            0x4DEE2301, 0x8903E150, 0x82E7D644, 0x7D3B302B, 
            0x97A5D648, 0x28474F7B, 0x48EA6BA8, 0x041D85F4, 
            0x3E9C85FE, 0x93C55A1E, 0x603BC109, 0x98D50B56, 
            0x8CF0F82C, 0x4528EAD6, 0xC71355D3, 0x0CC76C09, 
            0xCF39A2F2, 0x3E812B8F, 0x1D084042, 0x2CAC4058, 
            0x4BF761D3, 0x3DD2E6F0, 0x4CFC73BF, 0x024BEFBD, 
            0x437E1BB2, 0x0A128ED9, 0x755F0E20, 0xB7CBBE7D, 
            0x1E252082, 0xA7B577CB, 0x7BE729FF, 0x26183714, 
            0xAFE58B40, 0xC194EC8B, 0xECE864E1, 0xC0F97457, 
            0x4C2F6807, 0x96E92A67, 0x5604C1E9, 0xEAC093D5, 
            0x92F960AC, 0x3638892D, 0x7AC43AB4, 0x1FB09125, 
            0x0F148E10, 0x8F2659F7, 0xE1F281BA, 0x59AFFFEE, 
            0xD98E8F90, 0xA002A643, 0xA5875DF7, 0xAB4FFFEB, 
            0x12E8C30F, 0x7B43580D, 0x3B2F413F, 0x1650CA88, 
            0x62C0F2CA, 0xFF97974F, 0x9403C583, 0x21210F44, 
            0x35B035D9, 0x42B2C710, 0xF6A4CC89, 0x55E1457B, 
            0x1D6CDE2B, 0x4B2FFC71, 0x48AC7F77, 0x24B01220, 
            0x886B2759, 0x24B1965C, 0x4A95A205, 0x56EFA766, 
            0xAD93A31F, 0x8120DFD0, 0xC83A7C48, 0x345498CD, 
            0x58F30511, 0x1397814E, 0xA4DA4994, 0x7476F266, 
            0x7738687E, 0x6AF267B5, 0x98BDA903, 0x87A4EEFF, 
            0x2E4D7E83, 0x1C860C87, 0xEEFC0C1E, 0x5FDE691E, 
            0xE578C4F9, 0xB9E39657, 0xD93CB064, 0x5CC99499, 
            0x738CE7C1, 0xFB7679FA, 0xF6B627DE, 0x51E88791, 
            0x609F1885, 0xDA278698, 0x64A16812, 0x6833083C, 
            0x6BEAB663, 0x4BEBAD8C, 0x96359773, 0x7A085D68, 
            0x5E5ECFCF, 0x7D6D3A8E, 0x8DA5268B, 0xC4C09CDE, 
            0x7E8285DF, 0x3AD02E6E, 0xD7363FCC, 0x3E8D1F68, 
            0x4492866C, 0x36E40142, 0x61937301, 0xFBD4D235, 
            0xCB80B61A, 0xD57A037D, 0x8B337B15, 0x96EAE56E, 
            0x561BFEAE, 0xCC7301A1, 0xD40C4206, 0x7A190D84, 
            0x8436F574, 0x72082D5E, 0xD5707106, 0x9A93F158, 
            0xAB143D08, 0x0D351340, 0xC60C8787, 0x87B639EC, 
            0xF5F6812D, 0x809C903A, 0xE8DD0494, 0x02014F19, 
            0xD00A5507, 0xD165BE2A, 0x6416385F, 0x88B95FE5, 
            0xF5DA4B8E, 0xE34B6156, 0x3D321226, 0xEE8FB27D, 
            0xC828A132, 0xF0864793, 0xD9C606EF, 0x428632BF, 
            0xAF3A90C1, 0xCE8CB4D0, 0x59857636, 0xC1FBA98A, 
            0xCEE41BAA, 0xE3F49B0C, 0x9939A0FD, 0xF06AB962, 
            0xED8D712D, 0x5C4B7417, 0x5EC9BD96, 0xFE07FBB6, 
            0x625516E1, 0x048269AC, 0xE0EA0E52, 0x03045FBD, 
            0x99516E44, 0x20C32BAB, 0x5810FF43, 0x37F06D42,
        },
        {
            0xD12A070A, 0xA660B4DE, 0xF2A1CCF9, 0x1D66D275, 
            0xFA495648, 0x1C4ED4E8, 0x30979B95, 0x54E48260, 
            0x9AAC069A, 0xD5B631A9, 0x74656733, 0xDD43F623, 
            0x964F48A0, 0xAD2CEDDB, 0xD9060A55, 0x799E3197, 
            0x330EA163, 0xC762D039, 0xE66B3A9A, 0xB111C4DE, 
            0x6150B0CB, 0x1E2D99E9, 0xB7166CC7, 0x8EDE80C9, 
            0xEA90D9E2, 0x16D9E65F, 0xFD473598, 0x015A3ABD, 
            0x9531BD11, 0x8418FE68, 0x9CD48AA6, 0x283B0E55, 
            0x9ED4ABA1, 0x95EA30E3, 0x43A27F20, 0x49A5DA6C, 
            0x7287CDD0, 0x74D69FAC, 0x0605F6E4, 0x55FFBE2D, 
            0x702E9ACF, 0x1BB957A2, 0x28830023, 0xCF35148F, 
            0xB0618B6C, 0x23CE9DCB, 0x2E2F0260, 0x6623987B, 
            0x8A7367E8, 0x8E364A52, 0xAB465221, 0x7EDE36BA, 
            0x93915728, 0x000C153B, 0xFA19E8AB, 0x27876233, 
            0xD172C4D6, 0xAF906E8A, 0x620F11B5, 0xAD139BED, 
            0x50A7AD01, 0xD6A7F5A8, 0x65AD683D, 0x0E825684, 
            0xA674036A, 0x7A1B1A94, 0x433CC1EB, 0x21063FF9, 
            0x716E8930, 0x8E812A0B, 0xA73B312F, 0xA581E576, 
            0x22ED7DFD, 0x7428253F, 0xFAAB8C5F, 0x6D9719FC, 
            0x1B38E23F, 0x73C4176B, 0x75341560, 0x95548909, 
            0x33CC0054, 0x930DF0DD, 0x7B0B0598, 0x2662FBEA, 
            0x90C6670D, 0x32C8E590, 0x99BDE667, 0xAB50F431, 
            0xA4CAFE90, 0x2BA2E258, 0x90A627C4, 0xDF0BABB5, 
            0x6E010AF7, 0x6AEE21A4, 0x195AE2CA, 0x80F5E3F7, 
            0x33C9FBEB, 0xB08F9BF2, 0x9A7AFBFD, 0x6793573D, 
            0x06027DFC, 0x5C948AF0, 0xB0338E69, 0xADB51B5F, 
            0x167836F9, 0x04211D74, 0x6E26D700, 0x6B6FA535, 
            0x712E39E9, 0x029A0484, 0x3FCA9F5D, 0xB9CB2EEB, 
            0x63D93343, 0x6C27D2FA, 0xBA30AD09, 0x6E53EED5, 
            0xF20746B6, 0xDB64A57D, 0x8C7E7A45, 0x4592CDEA, 
            0x3E1795A6, 0x1D980C11, 0xA3D65F9C, 0xB28B3E71, 
            0x838F0A38, 0x1D6755EA, 0x55EC159D, 0x45A30F3E, 
            0xF0A4D6EE, 0x70509590, 0xFD1717D6, 0xC76A3B2D, 
            0xD493A615, 0x91F555A9, 0x802ED79B, 0x86E187F0, 
            0xFE77E9DD, 0x90AFB7AE, 0x3945BDA8, 0xD3E37428, 
            0x9747A30C, 0xBD342AE3, 0xE5DCAB04, 0x40275B79, 
            0xFB6FB86C, 0xC6FF72E8, 0xA735D363, 0xCDDB08F2, 
            0x4098F61A, 0xAE339D78, 0x6ED90B27, 0x5F90ED89, 
            0xDDF3D806, 0x1568ABE6, 0x1FC57688, 0x672E7C31, 
            0xA14E8857, 0x51CA3386, 0x4D09A2AF, 0x1A1FBFE3, 
            0x4DF8CF8E, 0xB4DDB5B8, 0xA0104103, 0xD7E5D8DD, 
            0xB364E771, 0xE82CAD7E, 0x5878E085, 0xB5E3AF18, 
            0xBF3517DD, 0x7EBF45BD, 0xEB899BA4, 0x1B6D517E, 
            0x10C8B82C, 0xEB064B66, 0x82D566F8, 0x90EE27D4, 
            0x7C6479BD, 0xF28DF432, 0x52E8494C, 0xCE89144D, 
            0xA3FB795C, 0x05447C01, 0xFABE94BD, 0x7C25CB83, 
            0x9358A1E7, 0xECD82B87, 0xF0602D7E, 0xF2E43513, 
            0x58E0DB62, 0xF0C8276B, 0x7E3A5AB4, 0x4078B561, 
            0xF40BC8F7, 0xE42F6AEE, 0x8164EBBB, 0x27725340, 
            0x0E38559C, 0xD69BB996, 0x89E309BF, 0x785CDD65, 
            0x191170A9, 0x99569485, 0x65E6A5A4, 0xEC62CAF4, 
            0xE1F7482D, 0x38CE7F9C, 0xB8413426, 0x01F104E0, 
            0x08A575F0, 0x57724708, 0x069F3D3E, 0x2668C241, 
            0x05F3A57B, 0x8CD7A804, 0x75311BC9, 0xDC95EDCD, 
            0x711FFE10, 0x04CF9FE3, 0xFA07F9C3, 0xD0824697, 
            0x956B28E6, 0x2B695F16, 0xEE159A44, 0xBB5170A8, 
            0xC1ACC196, 0xB48CC1E8, 0x6DE6213C, 0x77E2552E, 
            0xF5056777, 0x955CDC56, 0x97B005DB, 0xE09FC901, 
            0x2319BA93, 0x241057B2, 0xD70DFB8E, 0x709DC2B3, 
            0x730BE4A0, 0x62BC71D6, 0xABFE0CAE, 0x9D4C3A17, 
            0xB6C2A1BF, 0x7F6F1013, 0x43475BBF, 0x8708C7C9, 
            0xD8F326BD, 0xB0A32CD7, 0x8A760A17, 0xD317C63B, 
            0x84335E63, 0xA937C2EC, 0x3ECC5557, 0x79610B38, 
            0x8DA8781A, 0xB5DCDE36, 0xB82DE4B9, 0x00785C59
        },
        {
            0xBF5AE857, 0xBDA8D576, 0xEE333120, 0x1A29FDE9, 
            0xDC24DB4C, 0xBFA57E94, 0xB7E8D4E3, 0xC1816BB1, 
            0x1C92EA1D, 0x95FDD7D6, 0x2321164B, 0x6992CA56, 
            0xDFB72D5B, 0x943DB510, 0xE0A398B0, 0xAF32AC84,
            0xB6AAA704, 0x5070AE54, 0x6B480FBF, 0x63CB067B, 
            0xBD055592, 0x49C44148, 0x763BAE92, 0xCCC6946A, 
            0x35A0A92D, 0x6F2D63AD, 0x27BF8B04, 0x43A50F44, 
            0x7C92E1D5, 0xC0EAEBCE, 0x71508149, 0x5054BD54, 
            0x75185CB7, 0x79C049D0, 0x921B459C, 0x53C11D52, 
            0x8F0C570E, 0x8ED5895D, 0x9479710A, 0x013CC9C2, 
            0xF122336A, 0x851B8214, 0x209BA361, 0xDA607067, 
            0x0E95EC3B, 0xE0D0F2D0, 0x40D90E84, 0xF50AE203, 
            0x372A6D08, 0x5D935429, 0xF7960712, 0x8FB7C6A4, 
            0x9946822D, 0x6EC1E889, 0x4B3A0D91, 0xEA92B3EB, 
            0x02A915BB, 0x0FAA8BE7, 0x32B4DE8F, 0x4DA14705, 
            0x445EDBF7, 0x0527C9F7, 0x1CE0CED5, 0x42BC2BC4, 
            0x5A0CECE9, 0xBF2980BB, 0x2D111CA2, 0x41F720A1, 
            0x82EAAFC9, 0x9F3C6867, 0xCA0FAEB0, 0x3D958FD9, 
            0xB6797A3B, 0x208D4C1B, 0x77BFA5CE, 0x02F7978D, 
            0x3C7BEBF9, 0x8C601E0D, 0xBE3BE004, 0xE2F1A904, 
            0x077CDEB0, 0xF5EDBA20, 0x0CB11CE6, 0x43F111B5, 
            0x0EF735D3, 0x0F480ED7, 0xCD720D35, 0xFF2BF093, 
            0xFA078D03, 0x30B21E74, 0x7CC5AC80, 0xEF2D6F73, 
            0xFCE89815, 0x15DE05A5, 0x640E331F, 0xCC25BC71, 
            0x872C44BC, 0x811FDAC1, 0x1F68B765, 0xFDF28D74, 
            0x5E65D9A2, 0xEE37701E, 0xA56A33A0, 0x78E674B6, 
            0x3FF71C80, 0x3D157751, 0x57B6E79F, 0xA7A90F15, 
            0x81EBAE19, 0x3BBD29F5, 0xF19B68E1, 0xE4D3D315, 
            0xEF4BE550, 0x4A0430F1, 0xE5BBF62F, 0xAC3B585D, 
            0x3FE3D3B9, 0x108BD3C9, 0xE6B72729, 0xE980B323, 
            0x23D7FF4A, 0x460D8D03, 0xF5F0DCE1, 0x39641714, 
            0xAA1DB81E, 0x80B6BE66, 0xA8CD1311, 0xC217883B, 
            0xE7DF6066, 0x41BCF7D3, 0x6C1A6AE9, 0x4C6DD0A6, 
            0x2A00926F, 0x18B693FC, 0xD849C0CA, 0x2DA0DA46, 
            0x36B9A552, 0x116D8C9E, 0x538FFF76, 0xC88B9635, 
            0x98F7D193, 0xFFF5488A, 0xF8EE04D6, 0x09570A39, 
            0x14618FF3, 0x196B7539, 0xD0B29661, 0x7884BEE5, 
            0xD33D638C, 0xC7D06371, 0x22793F88, 0xAC16E4F2, 
            0xB6F93896, 0x2CB119F8, 0x6DA2D6E8, 0x2753ABDB, 
            0x67EB3B25, 0x9EB14126, 0xC9BE26B8, 0xF99FB607, 
            0x6455F80E, 0xDD14DF31, 0x5F7A57F1, 0x149D59EA, 
            0xE2D37A1F, 0xACB83090, 0x5EE9949D, 0x6DC24DE7, 
            0x4EC727BC, 0x4A5FC15A, 0x55A0C6FC, 0x76A704A4, 
            0x8483E93F, 0x85E15C70, 0x07336032, 0xA6A25F4B, 
            0x4A06B33F, 0xF42EB26F, 0xA1761059, 0x31A0474C, 
            0x76855A3D, 0xE58F6263, 0xB0FD98BF, 0x5FE4C3F6, 
            0x613A89F9, 0x738645F3, 0xEEDA3E6D, 0xB705BD4B, 
            0x64ECEBB6, 0x49FE3CFF, 0xBC6ECB2E, 0x9C09812D, 
            0x770395D6, 0x05A703D9, 0xE8B53B29, 0x46B038A0, 
            0xB043BC8E, 0x7FF532D2, 0xF9C84F7E, 0xFB693AFA, 
            0x781D8C65, 0xD1377314, 0xA1D3DC79, 0x322B202A, 
            0x9FE7B688, 0x7BB0F4F4, 0x1FEBE72A, 0x04FA0E1D, 
            0x1AEDF076, 0x52961D23, 0x01CF0F06, 0xB2A6849E, 
            0xD36CF1D6, 0x4FB6A4B6, 0xD0F634AB, 0xB2A764B7, 
            0xF033B020, 0xF6D40C61, 0x00C31E7A, 0x2C3F8F16, 
            0xCDF46349, 0xA08917E5, 0x74E07FEB, 0x12F43124, 
            0xABCE5F8C, 0xE757B321, 0x983C4AB7, 0xE189DBA0, 
            0x22C64ED8, 0x2766A289, 0xCB144AE6, 0xA0ADEE0A, 
            0x79458CD4, 0x4A079F10, 0x645FC852, 0x232D4F23, 
            0xEBB45CB4, 0xBC641269, 0xB150AEB1, 0x2198B341, 
            0x3B70232E, 0xDAA7703D, 0xE0D7CA8B, 0x8A1D6994, 
            0x0DA951A4, 0x54CA330A, 0x5765830B, 0xFECEC571, 
            0x9C33399C, 0x7D5F0060, 0xEFC9BD5F, 0xBDEBD4AC, 
            0xD5E95FCB, 0x9E6020AF, 0xB76166B1, 0xC8BD2E6B
        },
        {
            0xDE7A876A, 0xE307E8A5, 0x10E08C98, 0xD4D0C9BC, 
            0x2B3D54E2, 0x4BA0F0A1, 0x6A6B1AE2, 0xFBBC9C1E, 
            0x6952B266, 0x6D9B763B, 0x74D66304, 0x21BA2BD7, 
            0x620EC570, 0x9B61B1D8, 0x8F2FACD4, 0x5BC9F6AC, 
            0x446A6D3D, 0x006BFCB6, 0x452C8B1E, 0x9FDEAC70, 
            0x8C4B7F4E, 0xFDDB86CF, 0xFE2E53DD, 0x0F4A3D2A, 
            0x0739111A, 0x120208DB, 0x7553185C, 0x5262F7AD,
            0xC95C9292, 0x8B2043A1, 0x52C75F13, 0x7DDD68AB, 
            0xCF896BC3, 0xC3112981, 0x4902DA2D, 0xAF7D844E, 
            0xDC825C26, 0x80130612, 0x70C5F4E0, 0xAC27EA6B, 
            0x3015B697, 0x5ADE02E8, 0x9BAA9615, 0xC5DA22BD, 
            0x67954A6B, 0x15822FA1, 0x502D2F92, 0xD6746958, 
            0x950A058C, 0x7A799BCB, 0x68A6A550, 0x6244070F, 
            0xBD2578DE, 0x624507DF, 0x1BD6CB27, 0xEC0F1536, 
            0x8EAA8367, 0x64BA471D, 0xD3A9B67A, 0xB67C47E6, 
            0x609B3CB4, 0x25A7C918, 0x2D965795, 0x105FADDE, 
            0xB7E69E7A, 0x5CBD87B3, 0x430B6079, 0x0AFD5FBF, 
            0x7BD5AFE8, 0xB58E4520, 0xA592DFED, 0x540E3DFF, 
            0xB6ACECD7, 0xC3058B4C, 0x213FD54D, 0x779EB523, 
            0x02CAEFE4, 0xACDF922C, 0xB9DB4AB4, 0xEFD86709, 
            0xF9DB6149, 0xB6640863, 0x68437F9E, 0x466DD8F1, 
            0xBC70D726, 0x6D007AFC, 0x073F57E1, 0x0E1C77D2, 
            0xA9AED740, 0x52CD05B6, 0xE6554FA0, 0x7C99E11C, 
            0x967BAA86, 0x7E332BDF, 0x0A2D7857, 0x5B6138B2, 
            0xA0469567, 0x08071989, 0x10159A92, 0x2926604F, 
            0x3CE35D45, 0x875548A2, 0x3743C4F8, 0x739D6A89, 
            0x24877F48, 0xA6D3A722, 0x06CA2747, 0x27773089, 
            0xE9840B7B, 0x7B0870E3, 0xC71D7251, 0xCD9C35F7, 
            0x2732580C, 0x5DAFCA36, 0xAA3407E2, 0x33C96316, 
            0x5ADA6964, 0x70682AB9, 0x410D5F43, 0x2A43E494, 
            0xCAE17789, 0xFA0A37B5, 0x125C3986, 0x2C35E5E6, 
            0x06853FAD, 0x9F2BE6C8, 0x1892C32B, 0x72330D8B, 
            0xF4873415, 0x44BC1729, 0x0484CA9B, 0xBE5C233A, 
            0x1AF66A07, 0xD1E1B42B, 0x314CFF4B, 0x86288346, 
            0xDB7A4340, 0xBD708C1B, 0xCD2B90CC, 0xC2A4EEB5, 
            0x48A4674F, 0xD91D2AF0, 0x574081AC, 0xCB0C35A2, 
            0xF3E774E5, 0x38545141, 0x71C30FDF, 0x8D734A1D, 
            0xFB319E73, 0x5E91B02E, 0x3930EC70, 0x8EAEB2F1, 
            0x8011B9A3, 0xCE45B39D, 0x24F3110B, 0x1B782E56, 
            0x52A73EF8, 0x2206C53B, 0x4ECB93AB, 0x74C24138, 
            0xFB0C87FA, 0x3E40AE6B, 0x9AB7BB34, 0x0362F2F0, 
            0x9F39D3EB, 0xABBEC808, 0x56C5206E, 0xA2563C3D, 
            0x1E61546D, 0x8BB7F554, 0x6D6F9D36, 0x1C411DDE, 
            0x909DBB91, 0xBBBEDEC7, 0x71BDAAA3, 0x03C6F17F, 
            0x2DC44F9C, 0x4BD0D060, 0xCD34725A, 0xF69E7525, 
            0xEA05B7E8, 0x72B79414, 0xC743099C, 0x713EE04A, 
            0x26DFE596, 0x7675BB63, 0x8F1E29F8, 0x4D86CCEF, 
            0xD916B87A, 0xE11A99CD, 0x13591E15, 0xFD07AA9D, 
            0xE45B8141, 0x8B2EE1FA, 0xC45B54B3, 0x748F5275, 
            0xC0464BC7, 0x89204FE5, 0xB8E26306, 0x18483B39, 
            0xC3DD4D54, 0xEC24A2D9, 0x13D9D118, 0x5D7B9573, 
            0x1EF5DF3F, 0x131E1D5C, 0x600ADA1A, 0x77D02602, 
            0x373FE08D, 0x0CFC01C2, 0x18F8DF70, 0x2AB1E54D, 
            0x32C8D8CC, 0xED729557, 0xE1763759, 0x3B728AD3, 
            0x7A4013E0, 0x6576AB80, 0x92C06264, 0x9ADDC7F9, 
            0xCD0B6262, 0xC25AD1DC, 0x1BB8933A, 0xC6EC7B83, 
            0xD8564FF9, 0x9507EF98, 0xDA64EA3A, 0xBAB5A3C3, 
            0x63170449, 0x08B68943, 0xFB216862, 0x8FD7D076, 
            0x35A660A5, 0xA8A79113, 0x2B056989, 0x8CE8E346, 
            0xAFAF4B10, 0x11029A34, 0xDBAB96AF, 0xD04C8F8A, 
            0x09E16462, 0x7E6458A9, 0xBA3BAA2D, 0xD0430D09, 
            0x4FE41BBB, 0x7BF5189F, 0x6AAD1D94, 0xA3AB4406, 
            0xC36803C4, 0x166D6AED, 0xB85450C5, 0x3264794E, 
            0xE39CADD8, 0x1689C696, 0x73D47522, 0xB025ED7A
        },
    };
    unsigned int datal = 0x00000000, datar = 0x00000000, data;
    BLOWFISH_CTX ctx;

    for (i = 0; i < 4; i++) {
    for (j = 0; j < 256; j++)
      ctx.S[i][j] = ORIG_S[i][j];
    }

    j = 0;
    for (i = 0; i < N + 2; ++i) {
        data = 0x00000000;
        ctx.P[i] = ORIG_P[i] ^ key[i % 4];
    }
    
    for(i = 0; i < 18; i+= 2) {
        blowfish_enc(&ctx, &datal, &datar);
        ctx.P[i] = datal;
        ctx.P[i + 1] = datar;
    }

    for (i = 0; i < 4; ++i) {
    for (j = 0; j < 256; j += 2) {
      blowfish_enc(&ctx, &datal, &datar);
      ctx.S[i][j] = datal;
      ctx.S[i][j + 1] = datar;
    }
  }

    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedP, ctx.P, 18);
    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedS[0], ctx.S[0], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedS[1], ctx.S[1], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedS[2], ctx.S[2], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedS[3], ctx.S[3], 256);
}

TEST(Crypto, blowfish_enc_192_multiple)
{
    int i, j;
    unsigned int expectedP[18] = {
        0x68209558, 0xd4be58ee, 0x776efe18, 0xbb80e2ab, 
        0xad261c1a, 0x58547ede, 0x51bed131, 0xa6144272, 
        0x75393c22, 0x7e2c74c5, 0x24033b4b, 0xeddf5afe, 
        0xd2858b5b, 0xfd5e03b0, 0x8c7abe1f, 0xf0459a0f, 
        0x92dd17a4, 0x86b2b779
    };
    unsigned int expectedS[4][256] = {
        {
            0x13adcf52, 0x201912d1, 0x9f8968b5, 0x96cf7136, 
            0x92d04b69, 0x8ef7f2ea, 0xbd4d44ac, 0x16097e05, 
            0xeac447b2, 0x12a51b33, 0x526af407, 0x648a0a8a, 
            0x477a719f, 0x33fe1e0b, 0xb356eae5, 0xd113ff74, 
            0x29efe351, 0xdf287d7a, 0x9e52488a, 0xb52c7fd2, 
            0xe0ad7def, 0x3f957427, 0x6aac137e, 0x36d71c30, 
            0x35dbd325, 0x95927491, 0x13719e43, 0x017081d1, 
            0xbc1c83b4, 0x577709b1, 0xf2d6f97d, 0x5cca0332, 
            0x97d18df4, 0xb8e24f10, 0x25928669, 0xce831f3d, 
            0x2d812dd1, 0x64df4062, 0x11abcae2, 0xbd58bb16, 
            0x195a099a, 0xfbb9812f, 0x69940abd, 0xeea79e23, 
            0x8ac79b89, 0x7ab35874, 0x5b0a82d1, 0x92f3a05e, 
            0xf9683bc0, 0x274b8146, 0x66783c63, 0x3aea178d, 
            0x9dda7fac, 0xe8f53327, 0x5fab9f89, 0xb6e1e4ac, 
            0x274a95a9, 0xe6b5dd1e, 0x0d96a900, 0x1a0267b9, 
            0x5c70292f, 0x165ed216, 0x13181806, 0xc2e96442, 
            0xc6a60f77, 0xd85c703d, 0xd4d4860b, 0x63bed4cc, 
            0xad834d6b, 0xdb419917, 0x7e482f26, 0x46ae9cff, 
            0x242a6b90, 0x87a680dd, 0xac58110e, 0xda6f4360, 
            0x68937bb0, 0x5c96b181, 0xf4cd8073, 0xf9b5ea09, 
            0x4f07a3e1, 0x5d75e799, 0xfe8bbb41, 0xf2dc7e3f, 
            0x721deb0f, 0x88c1dce4, 0x0fbc84ea, 0xd97c69da, 
            0x4613c0a7, 0x81422cd2, 0xe28b36ff, 0x192332a8, 
            0x55ca6a4d, 0x4bd0b55d, 0x81f42744, 0xdf6b8257, 
            0x01798e85, 0x948bda8d, 0x70652ca3, 0x5a3cd347, 
            0xd02ff745, 0xbde07dbe, 0x5af8eaad, 0xdb551d3a, 
            0xe714b335, 0xdd85b2a4, 0xfcb07eaf, 0xf9665bba, 
            0x0a1ee6ac, 0xbdef3f5e, 0x2a4887fd, 0x65bb1a0c, 
            0xbe031d01, 0x3cb4e589, 0xb1f07c1a, 0x49c58339, 
            0xb647818d, 0xdd21cc8d, 0xbdb5ee69, 0x2b7b79d3, 
            0x748c3ca6, 0x432dc314, 0xb319cb29, 0x9ab37fd9, 
            0x0335cbb2, 0x29a6e174, 0x2f65ab29, 0xb5c7d7d0, 
            0x7f26c9a3, 0x99e53318, 0x9dc4597a, 0xa18d9e9f, 
            0x00168385, 0x70499fde, 0x1bb97e3d, 0x797ab72a, 
            0x13a76f09, 0x998663fd, 0xd13fec26, 0x1df613ac, 
            0x38ee4dc4, 0x9b487187, 0xc6ed3cb6, 0xb2170c7e, 
            0xb19de5b5, 0x84038387, 0x3bd968e4, 0x311e0a0c, 
            0x2dc9f294, 0x4e55996c, 0xb771836f, 0x07203828, 
            0x04cc9b16, 0x05e7ef8e, 0xf543f579, 0x4a8ce542, 
            0xb8a80891, 0x5298c916, 0xabc2dea1, 0xda13c4fc, 
            0x901f059a, 0xd4e5db85, 0x0955965b, 0x78a81456, 
            0x0f77c8b6, 0xc384070c, 0x44475909, 0x6d3fcf9e, 
            0xdc67032a, 0xb405622c, 0xf944c95c, 0x1710f7b5, 
            0x73b6bdd2, 0xc9dae571, 0x4278bcc2, 0x03e3bba1, 
            0x88da0a06, 0x524f0e64, 0x5e0f17a6, 0x3f8191fd, 
            0xe7d3dcc5, 0x953d10b7, 0x52f960e2, 0x9d18c2d8, 
            0xb20baf2d, 0x99153dfd, 0x9d69cec8, 0x9db66ec7, 
            0x95bbe90b, 0xc02cf7ef, 0x35d69b80, 0x014e25af, 
            0x74b39b73, 0xf477ca80, 0x07551999, 0xba34eb1e, 
            0x0def491b, 0x40c15ff4, 0x9d423571, 0xda0a6626, 
            0xb0d469ad, 0x8b566942, 0x52bd1a50, 0x4e4856c5, 
            0xc0f63cba, 0xb5680870, 0x94d29f52, 0xd17cb4ac, 
            0xa201b794, 0xef3189c6, 0x853d2454, 0xbfc39b8b, 
            0xfa4b3f99, 0x71b443bc, 0x04935889, 0x7450c863, 
            0xb48fa3ba, 0x67f0a772, 0x0f5dfb73, 0x0443a530, 
            0xfe4dcad4, 0xf334c1eb, 0x95b29b2c, 0xeb241d52, 
            0xe9d9637f, 0x1a3a1f97, 0xbc2e9397, 0x65954b8c, 
            0x5dbc5e5c, 0x4acbbaae, 0x012ef91d, 0xad560476, 
            0xd87ec7fa, 0x3a558a47, 0xa14593f6, 0x9462cb86, 
            0xdcfac996, 0xe5bab7ad, 0x781e4d7d, 0xda524081, 
            0x538fc0e9, 0x420d6bc1, 0x93c8b16e, 0x2cabddff, 
            0x1e7169eb, 0x47c4aeed, 0x8cfbe2b6, 0x78e8fe80, 
            0xf9ff956e, 0x3fa3473f, 0x1022af48, 0x53af7b9b, 
            0x56be58d8, 0xf1243797, 0x18fcfa0b, 0xe16bd434
        },
        {
            0x52967289, 0x49addf8c, 0xdfc446ff, 0x887b7aa3, 
            0xbf4dc531, 0x248a7b74, 0x27cf50e1, 0xb16ad1e1, 
            0x4d663e36, 0x8a164dc1, 0x69bafd96, 0x9cdb16ab, 
            0xc0d74540, 0x8cd07806, 0xc2a0c70c, 0xa2a92dc8, 
            0x3c184195, 0xe60c114e, 0xbf64885d, 0x6c839a4a, 
            0xe011cdfe, 0xacf10d1d, 0x74b8a7f1, 0xd8fac40d, 
            0x5e059fa4, 0x84dd673e, 0x3c1a2150, 0x452bb3f2, 
            0x412237e9, 0xf950f135, 0xa1a25ddb, 0xee38cdf8, 
            0x97dcfa83, 0x12b9b2c4, 0x8a9e1ccb, 0x447e921b, 
            0x48ed7b5c, 0xf8b1093f, 0x889f3728, 0xc73a8f82, 
            0x7633ce97, 0x1e2c5113, 0x642b69dc, 0xab4653d9, 
            0x1f42a830, 0x8ae7d0cf, 0x55daec4d, 0xadcce9fb, 
            0xd84f331c, 0x1ec861a3, 0x609f63c9, 0x5d49f6b9, 
            0xe66fd42c, 0xc4df830f, 0x612ec69e, 0x74688a82, 
            0xed1c4be5, 0xc8f44936, 0xf32077f0, 0x3a2af26a, 
            0xd0ab82f4, 0xd5b96004, 0x042bad97, 0xc2bfde25, 
            0xbe4d9266, 0xc0393ef3, 0xc819f93e, 0x807cee98, 
            0x2fac9ba2, 0x9b8be9a8, 0xd4481f19, 0x3701326a, 
            0x001a97c7, 0x1671cbdc, 0x127aa85a, 0x6d3c6cd3, 
            0x9fdc43e0, 0x33e6b00f, 0x73d06dfe, 0xeb3923f0, 
            0xdc6b8aab, 0x621871cf, 0xe82515d1, 0x2a75ebe7, 
            0xdadff1a2, 0x2c566894, 0x93220026, 0xd9dafdd7, 
            0xb6dca107, 0x1b63c7cb, 0x7ecf9ff0, 0x19370018, 
            0x38136855, 0x284951a0, 0x885e1332, 0xf725b0b1, 
            0x7ec71ab2, 0xd9be97bd, 0x7320a910, 0xee146be0, 
            0xa9cf32c9, 0x2f6c5ccc, 0xd6339044, 0x14d5530e, 
            0x03b0c23c, 0x12787a92, 0x1caa9498, 0x7c4584af, 
            0x9795766a, 0x09c270b1, 0xa325c544, 0xdd47b2b4, 
            0x3beb2930, 0x2cbcb647, 0x62c73e57, 0x49dac824, 
            0x80b76904, 0x1f6fbeff, 0x551aa478, 0xa88ecfa0, 
            0x772a5b48, 0xda76777d, 0x746ae5fe, 0xf7630b61, 
            0xb68038e7, 0x14cd4954, 0xcc2f27b0, 0x4f417e0a, 
            0x4df64a27, 0x368c21c1, 0xa1e7f5d5, 0x9bc8da90, 
            0xb1f022f3, 0xb7523189, 0xb6d955a8, 0x2abb3804, 
            0x2d7957aa, 0x31465033, 0x5b69c520, 0xb0f7caf3, 
            0x202d921f, 0x6bb1cd25, 0x4ad48f2a, 0x127b1793, 
            0x0016f5e1, 0x1e15dbff, 0x54ee3960, 0xecb61c57, 
            0x7a06ab1a, 0xdc620b4f, 0xa57634b2, 0x87c7a03f, 
            0x683d3385, 0xbfe818d9, 0x5a939a5b, 0xd1c404e5, 
            0xa654945c, 0xb4b65c23, 0x6de97d8b, 0xf572c03e, 
            0x88339cbc, 0x8a40214f, 0xc0f1bc56, 0x8f39bfe7, 
            0xa7efb42b, 0x03093291, 0x0a555138, 0x4d6c4f3b, 
            0x31478136, 0x629da8a7, 0x8cbca219, 0xc27ea0a7, 
            0x3808747a, 0xc376b1a0, 0x6e746a86, 0x79fc215d, 
            0xbc635270, 0x55bbf179, 0x39e3cc3c, 0x3b6bab39, 
            0xa3afd576, 0x22c49b39, 0x5063596e, 0xb376cd50, 
            0xe3e189ad, 0xacbf136c, 0x06abb62b, 0xbb8de067, 
            0xb3fd96c0, 0xf5053fc8, 0xa4ad066e, 0x0486ce90, 
            0xdba720ba, 0x576a5814, 0x62313a95, 0x5e987d71, 
            0x01858d76, 0x453c2e9d, 0x85688806, 0x6450708e, 
            0xf0eea75f, 0x0f33b839, 0x5cb8efad, 0xd377fc03, 
            0xd0b7df6e, 0x0b98ea31, 0x524c525f, 0x908f1514, 
            0x874879bd, 0x8236909b, 0xc448c09f, 0x29d6d1a0, 
            0xfa005d01, 0x8b6e1690, 0x74481ba8, 0x97bee745, 
            0x11b759f8, 0xfcbfa466, 0xa283c8e2, 0xd72f0605, 
            0x44598702, 0x63f96930, 0x3811fc39, 0x5739449e, 
            0x5de7f61d, 0x0996a6a9, 0xe591872f, 0x0a894595, 
            0xe180805a, 0xb13631ab, 0x61c24214, 0x3c0d5ad6, 
            0xf89e236a, 0xb3021bdd, 0x4af7bc53, 0x95f109d3, 
            0x9abab759, 0xa5bd2c1e, 0x3d099412, 0x8dff0382, 
            0xb867818e, 0x3388114d, 0x03f00a98, 0xbbc8fdbb, 
            0xdcdc2ef5, 0xc29bbb78, 0x8bcbde00, 0x693187a2, 
            0x91876282, 0x27562804, 0x93cdd092, 0x5facb260, 
            0xecb85b11, 0x0038a65f, 0xcc70ee43, 0xc78c2430
        },
        {
            0x32a7d026, 0x845e2aa4, 0xf9d884a5, 0x5dc222d0, 
            0xd936e5ec, 0xb13d8882, 0x44372de4, 0x05205e2b, 
            0x33d8fc2f, 0x361d0c01, 0xaa225bec, 0x75190d39, 
            0xa9d14620, 0x49648fec, 0x7a2bf2cd, 0x74271775, 
            0x611bcb51, 0xa41c89f2, 0x6d9ebbfa, 0x6cdc209e, 
            0x07d4f7e5, 0x897426a8, 0xad16deb3, 0x23c8160b, 
            0x4f34722d, 0xb2cd19a4, 0x025d9858, 0x7f823853, 
            0x03ab3615, 0xd6fd119f, 0x46874f1e, 0x129d0166, 
            0x9a6e186e, 0x53f20e59, 0x1a556e4c, 0x1ede629e, 
            0x56fa138b, 0x11a6841d, 0xb488128c, 0x1e6929ce, 
            0xf2ae8ca5, 0xbb8df0fa, 0x9fe2ad66, 0x9ebdca9e, 
            0x3d500f47, 0x0a7726b3, 0x00bcc9e1, 0xc95f1c61, 
            0x1f53a213, 0xf4af5c53, 0xa2ca0785, 0x2da39402, 
            0x6da3b957, 0x33a10c2b, 0xda3f1549, 0x48208b2f, 
            0x020c2624, 0x8a6f493d, 0x9bb529b1, 0x0d95231c, 
            0x3866b576, 0x855e52e5, 0x892645dd, 0x3b1a2d32, 
            0x0823083a, 0x43f3e435, 0x8c98cb2d, 0xcdc89bf2, 
            0x49f976c8, 0xa1a8be36, 0x776ef26e, 0xa289e9ad, 
            0x0dc470bd, 0x3a4146fb, 0x0e50cc4e, 0x6d933432, 
            0x42f7330a, 0x3be613bf, 0x2df67f6d, 0xb44a7ada, 
            0xf0d10a22, 0x9371c0bb, 0x7ce47225, 0x95575cec, 
            0xd628661b, 0x3d4cc949, 0x35c35bf9, 0x1002c6d5, 
            0xa4aa9423, 0xc498cad0, 0xa1ea70ad, 0x7b177470, 
            0xfd2cec99, 0x14660fe0, 0x16955607, 0xa660fcba, 
            0x0d1603e6, 0x80b71633, 0xd5ffa12c, 0x56e90a60, 
            0x5da1f44d, 0x13662766, 0x3fd26ed6, 0xf1d215ef, 
            0x3abb0a03, 0x347066bd, 0x23c7ef8b, 0xc9f7a4d2, 
            0x788823f7, 0x3f6b7cc1, 0x6f4799e0, 0xaaee854e, 
            0x425bfdc1, 0x47a1d246, 0x196bd7f8, 0x07ebd0a4, 
            0x5b43892e, 0x4ddc886f, 0xa21e776b, 0xa3510fce, 
            0xdc94d781, 0xa5386ab6, 0xedd2d4bd, 0x330c08e7, 
            0x999592f6, 0x77c34358, 0x24eb9191, 0x430ca07d, 
            0x874f206f, 0x1e0f4ef7, 0x21c3dc73, 0x09e93dab, 
            0xd5e8fc08, 0xcbfd1d3d, 0x0e830919, 0xb5529c6f, 
            0xb48641b5, 0xffaf5353, 0xb9ec9172, 0x5ec5cdbe, 
            0xb3928785, 0x26b9d1ea, 0x315244b5, 0xecde3734, 
            0x4e30589e, 0x3b1645e4, 0x8761faa3, 0xc8924449, 
            0xbad9b29b, 0x65e788a7, 0xbb193615, 0x1431f7ce, 
            0x6ba7429e, 0xc183f476, 0x92c7c573, 0x0b90dd7b, 
            0x102b243e, 0xa0235e5c, 0x7d5a5cdf, 0xc2eb7c62, 
            0xab6068fa, 0x787bd595, 0x3b0552fc, 0xcde375a8, 
            0x578d97c2, 0x0bfb0772, 0x93dd5fbe, 0x99fe8f3a, 
            0x33232ce9, 0x77b701ad, 0x1cc261e2, 0x65ec54ae, 
            0x5e4111b9, 0x89e39929, 0x0e2b8c67, 0x6d5bf27a, 
            0x6847162c, 0x50b34afb, 0x8debed87, 0x674d5f90, 
            0xf9cbcfcd, 0x37c7b457, 0x6be42fba, 0xecc50a5c, 
            0x7d8a8f66, 0x8cbe5d56, 0xd30d5b42, 0xc606c01d, 
            0x05687234, 0x7ab2b62f, 0x996c4393, 0x833108a2, 
            0x7b724ddd, 0x58cd4669, 0x62947055, 0x83c4d0c1, 
            0x000dd3a6, 0x18bc201f, 0xe60bcc1e, 0x7816fc91, 
            0x8c794965, 0x0552376c, 0xae5bf923, 0x96f7c9d3, 
            0xf3262b14, 0xc6e54fa2, 0x8c6e8932, 0x2cc576a0, 
            0x6484e3b6, 0x9b0dfbe8, 0x1121f88b, 0x20392ce1, 
            0xe6069909, 0x6d4168b2, 0xbecc4544, 0xc446a822, 
            0xb361359e, 0xfe39ee0d, 0x81501a98, 0x4b3415a0, 
            0x07db9f8b, 0xc2766d08, 0x3e88b1b9, 0x4a26e31c, 
            0x74d2e351, 0x917140f7, 0x271f65b0, 0x5a053f02, 
            0x138ab033, 0x39963c6e, 0xb94ff1ef, 0x31b52b1f, 
            0xf3b13b33, 0x4677a441, 0x2417ac74, 0x5a4fd813, 
            0xe4617069, 0x830d36f1, 0x225fc46a, 0x5b67bc36, 
            0xd8a44ebd, 0xc1dd8ffc, 0xa9a3efa2, 0x653ed2d2, 
            0xcac63ad6, 0x42d07c25, 0x214082ae, 0x5394d5b8, 
            0x0419c8f7, 0x3218e1ab, 0x8386040e, 0xcb6ad509, 
            0xf30fd5b3, 0x6ecf6751, 0x3de52ecf, 0x5dcda9fb
        },
        {
            0x4c563be2, 0xc2565af5, 0xdb3b1bc5, 0xc755c3f8, 
            0xbfdcf5eb, 0xac73e145, 0x33128151, 0x787c1285, 
            0x1e9cb8f1, 0xe1305eea, 0x22885305, 0x661c5e47, 
            0x697c241d, 0xa868d54b, 0xeb64f4c8, 0x6e707fca, 
            0x57cecaf8, 0xf3c36447, 0x0f18208d, 0x022fc139, 
            0x53f92020, 0x3f5bb82b, 0xaf4ddaf3, 0x2b3a3542, 
            0xe72230e0, 0x76a73543, 0xf84dfd7f, 0x0a2ea0ed, 
            0x73afa7e0, 0xa5df1c7b, 0x458eaf77, 0xf57255d8, 
            0x0d980bac, 0x96298e4e, 0xb75c6e6e, 0x2c3ad5bb, 
            0x824b6d38, 0x51c720e3, 0x39e022c9, 0xf434bda8, 
            0x087a2383, 0x852f22aa, 0x3313c762, 0x62a28a77, 
            0x2262b516, 0x7d62f14c, 0x766e344d, 0xf34fa48b, 
            0x5a1a2a3a, 0x641a4ad0, 0x1aa4cf38, 0xca05d696, 
            0x96fe962d, 0xbec8bf2a, 0x948ddb01, 0x52956c2e, 
            0x64f6fcdc, 0x733aaa47, 0x2581e1f8, 0x3bb1b3b3, 
            0xa7bfdd15, 0xb5273fe2, 0x0bb034d5, 0xc66e5f60, 
            0x45d5efcf, 0xc7f4693e, 0xef8ebe7b, 0xef48b85a, 
            0x16a7b9ad, 0x1057a75e, 0x5bfd9897, 0xec76b84b, 
            0xd7fc6102, 0x94bb3c28, 0x70f71996, 0xd4ebe19a, 
            0x6cc71994, 0xa9f6f63b, 0x00ba8299, 0xe38e4bc9, 
            0x5236c2a3, 0xf14b8849, 0x674c06ec, 0xd512c96d, 
            0x94343e23, 0x14c826d7, 0x464808f4, 0xe3a63ce6, 
            0x133b7a37, 0x7b517e75, 0x739ec0aa, 0x369e6967, 
            0xcabf639e, 0xa82ea379, 0xee2eec47, 0x111e83c0, 
            0x7c3067ed, 0xcd6db535, 0xbaf7b3dc, 0x5253da82, 
            0xf5bf1249, 0x1139bdf2, 0xaf7eff51, 0xa1c20984, 
            0x841d2cfe, 0x81e83b26, 0xe1e8f26d, 0x23a319ef, 
            0x1fcd3713, 0xdc4c63ba, 0x9b4decfa, 0x86cfaee7, 
            0x028012fc, 0x833846b1, 0x51f33410, 0x5dc09abc, 
            0x1c999035, 0xbd1ba8f6, 0x50c34f46, 0x4a2f8e55, 
            0x3d577d18, 0x9b1d8f9a, 0xec7767d4, 0xd2ec07b4, 
            0xc2e97cfd, 0xda292c8e, 0x9ac21e0e, 0xa750d237, 
            0x2f29c610, 0x17d39a7e, 0xce5ada75, 0x0c040f43, 
            0x779ec928, 0x23f78721, 0xaeb19b1c, 0xed906b85, 
            0x2124fc48, 0xc0d18fc9, 0x01bbc164, 0xcf5382cf, 
            0x5808f5c8, 0x870a427e, 0xad1608a4, 0x2cd68bb2, 
            0x6875203a, 0x6b2dc897, 0x5d2ea290, 0x04a81244, 
            0xbcf923a3, 0x43c308f3, 0xaaad9e55, 0x80b23082, 
            0x0a6ba33e, 0x711f8325, 0xbdfe3ad0, 0xf00c924b, 
            0xcb879b0d, 0x46a3122d, 0x69589ab6, 0x86a7de05, 
            0x99e5f1f5, 0xa44738b8, 0x96c99cc4, 0x12856438, 
            0x5f718004, 0xa6f4a80c, 0x4462e05a, 0x2e0a6bd9, 
            0x5d5c3576, 0x8ee80bc3, 0x8d8a6dc3, 0x70b63433, 
            0xa2325722, 0xd928f4d2, 0x491881f1, 0x135d59a1, 
            0xb2e38c71, 0xa186a93f, 0xc6610f85, 0xfad8c118, 
            0x97de9a04, 0x5b5c49a3, 0x947c957d, 0xe9b195f9, 
            0x31c01dfb, 0x933b9d24, 0x27ae7022, 0x5517e1e3, 
            0x1aa7e12f, 0xffaeb467, 0x4fe4832e, 0xbdc2ea4a, 
            0xc879a2d4, 0x6c539046, 0xbef0794e, 0xe6ad7217, 
            0xeab8a075, 0x3a2173bb, 0x27193c1e, 0x6ed253b5, 
            0xba441dc0, 0x5a4d28ba, 0xda7373d8, 0xf3b5e455, 
            0xbd4ec495, 0x03586ec0, 0x59d25eb0, 0x869431eb, 
            0xc6d4017c, 0xb33916c7, 0xbd430f5f, 0x78619506, 
            0x830fc8a4, 0xb8f7193d, 0x012b2bef, 0x20d1fbca, 
            0xab419c4f, 0x3e517c2c, 0x6c01caef, 0xbc4c3fed, 
            0x18e6a604, 0xe0d39363, 0x074231df, 0x5f88a7e8, 
            0xd36a9de8, 0xd75d384c, 0x35604232, 0xd7b65984, 
            0xaa018386, 0x2a2d982b, 0x6b41606c, 0xe3a3a2a2, 
            0xaff9ca91, 0xa3a5d314, 0x6fedc25d, 0xf3376a9c, 
            0xce1a011d, 0x063a8427, 0x9d5b1729, 0x709324d6, 
            0x1426d97a, 0xdf71a3e4, 0x0c289a32, 0x086f2f68, 
            0xd9d84427, 0x106faa3c, 0xc7727fd2, 0x035c55f9, 
            0x0786fe65, 0x72d07bc5, 0x185976a8, 0x938bec38, 
            0xd43e924a, 0x24c94e38, 0x86ee9d69, 0xe36df87a
        },
    };
    unsigned int datal = 0x00000000, datar = 0x00000000, data;
    BLOWFISH_CTX ctx;

    for (i = 0; i < 4; i++) {
    for (j = 0; j < 256; j++)
      ctx.S[i][j] = ORIG_S[i][j];
    }

    j = 0;
    for (i = 0; i < N + 2; ++i) {
        data = 0x00000000;
        ctx.P[i] = ORIG_P[i] ^ key[i % 6];
    }
    
    for(i = 0; i < 18; i+= 2) {
        blowfish_enc(&ctx, &datal, &datar);
        ctx.P[i] = datal;
        ctx.P[i + 1] = datar;
    }

    for (i = 0; i < 4; ++i) {
    for (j = 0; j < 256; j += 2) {
      blowfish_enc(&ctx, &datal, &datar);
      ctx.S[i][j] = datal;
      ctx.S[i][j + 1] = datar;
    }
  }

    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedP, ctx.P, 18);
    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedS[0], ctx.S[0], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedS[1], ctx.S[1], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedS[2], ctx.S[2], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedS[3], ctx.S[3], 256);
}

TEST(Crypto, blowfish_enc_256_multiple)
{
    int i, j;
    unsigned int expectedP[18] = {
        0xD05ED527, 0xB387F46A, 0xF27D2716, 0x4D96239D, 
        0xA917D911, 0x7FBD30E1, 0xC69A4AAF, 0xB37126BA,
        0x2D10CC63, 0x426762B8, 0xB360F4B3, 0x049BA48E,
        0x41225A67, 0xD740B824, 0x71A59E53, 0xDE08654C,
        0x4FA5CFD1, 0x7E6F46A4
    };
    unsigned int expectedS[4][256] = {
        {
            0xb96280aa, 0x9c83f428, 0x9723aabf, 0xd97d524f, 
            0x373d60c5, 0xe8a8f8c4, 0xf737f34f, 0x6ccccf89, 
            0x4b009111, 0x8a5da4cc, 0xf1502804, 0xf4eea5ea, 
            0xb105cabd, 0xa5adda54, 0x601a6237, 0x48d104e0, 
            0xddc1ea98, 0x8f7be962, 0x2a18af6e, 0x7ac32f59, 
            0xf53dee46, 0xde790bdf, 0x0f55c70d, 0xcecffe3d, 
            0xaa9a3f5f, 0x9150c381, 0x36765a13, 0x3eff667c, 
            0x619d24df, 0x1f368f3d, 0x3e233c25, 0x4d8678f1, 
            0x525eda6f, 0xa75c2af7, 0x91bc7b21, 0x87638352, 
            0x0c75c6dc, 0x4ac512b4, 0xe9608828, 0xbd9120ee, 
            0x350974d9, 0x2bff84e9, 0xf6a9e9e3, 0x4116acc3, 
            0x62eb033e, 0x63e6ced7, 0x80e569e8, 0x8000ef1a, 
            0xfa02cd0e, 0x2bbec82f, 0x5e19f919, 0xabcd1ac5, 
            0x82f70b65, 0xd11581e8, 0xc885f7a2, 0x5eff5e9f, 
            0xdbe5450a, 0xe94e9baa, 0x8f656fb3, 0x8cf173b7, 
            0xb2b0206f, 0xdb2d0ddb, 0x34227285, 0x4995a86c, 
            0xd4f4cb09, 0xfe4b7616, 0x15fe56d6, 0x3c6a52c6, 
            0xe23500d8, 0x7f7c874b, 0x461783b7, 0xb5622511, 
            0xfe9ae1c4, 0x0396056b, 0xcd3dbc92, 0x00b8e329, 
            0xce8bd607, 0xdebe411a, 0x0c866d1b, 0xe72a6684, 
            0xee79396c, 0xf5afa5b5, 0x37225a4d, 0x95885f09, 
            0x018f4292, 0xe74782d2, 0x8e861f15, 0x62faf35a, 
            0x4dee2301, 0x8903e150, 0x82e7d644, 0x7d3b302b, 
            0x97a5d648, 0x28474f7b, 0x48ea6ba8, 0x041d85f4, 
            0x3e9c85fe, 0x93c55a1e, 0x603bc109, 0x98d50b56, 
            0x8cf0f82c, 0x4528ead6, 0xc71355d3, 0x0cc76c09, 
            0xcf39a2f2, 0x3e812b8f, 0x1d084042, 0x2cac4058, 
            0x4bf761d3, 0x3dd2e6f0, 0x4cfc73bf, 0x024befbd, 
            0x437e1bb2, 0x0a128ed9, 0x755f0e20, 0xb7cbbe7d, 
            0x1e252082, 0xa7b577cb, 0x7be729ff, 0x26183714, 
            0xafe58b40, 0xc194ec8b, 0xece864e1, 0xc0f97457, 
            0x4c2f6807, 0x96e92a67, 0x5604c1e9, 0xeac093d5, 
            0x92f960ac, 0x3638892d, 0x7ac43ab4, 0x1fb09125, 
            0x0f148e10, 0x8f2659f7, 0xe1f281ba, 0x59afffee, 
            0xd98e8f90, 0xa002a643, 0xa5875df7, 0xab4fffeb, 
            0x12e8c30f, 0x7b43580d, 0x3b2f413f, 0x1650ca88, 
            0x62c0f2ca, 0xff97974f, 0x9403c583, 0x21210f44, 
            0x35b035d9, 0x42b2c710, 0xf6a4cc89, 0x55e1457b, 
            0x1d6cde2b, 0x4b2ffc71, 0x48ac7f77, 0x24b01220, 
            0x886b2759, 0x24b1965c, 0x4a95a205, 0x56efa766, 
            0xad93a31f, 0x8120dfd0, 0xc83a7c48, 0x345498cd, 
            0x58f30511, 0x1397814e, 0xa4da4994, 0x7476f266, 
            0x7738687e, 0x6af267b5, 0x98bda903, 0x87a4eeff, 
            0x2e4d7e83, 0x1c860c87, 0xeefc0c1e, 0x5fde691e, 
            0xe578c4f9, 0xb9e39657, 0xd93cb064, 0x5cc99499, 
            0x738ce7c1, 0xfb7679fa, 0xf6b627de, 0x51e88791, 
            0x609f1885, 0xda278698, 0x64a16812, 0x6833083c, 
            0x6beab663, 0x4bebad8c, 0x96359773, 0x7a085d68, 
            0x5e5ecfcf, 0x7d6d3a8e, 0x8da5268b, 0xc4c09cde, 
            0x7e8285df, 0x3ad02e6e, 0xd7363fcc, 0x3e8d1f68, 
            0x4492866c, 0x36e40142, 0x61937301, 0xfbd4d235, 
            0xcb80b61a, 0xd57a037d, 0x8b337b15, 0x96eae56e, 
            0x561bfeae, 0xcc7301a1, 0xd40c4206, 0x7a190d84, 
            0x8436f574, 0x72082d5e, 0xd5707106, 0x9a93f158, 
            0xab143d08, 0x0d351340, 0xc60c8787, 0x87b639ec, 
            0xf5f6812d, 0x809c903a, 0xe8dd0494, 0x02014f19, 
            0xd00a5507, 0xd165be2a, 0x6416385f, 0x88b95fe5, 
            0xf5da4b8e, 0xe34b6156, 0x3d321226, 0xee8fb27d, 
            0xc828a132, 0xf0864793, 0xd9c606ef, 0x428632bf, 
            0xaf3a90c1, 0xce8cb4d0, 0x59857636, 0xc1fba98a, 
            0xcee41baa, 0xe3f49b0c, 0x9939a0fd, 0xf06ab962, 
            0xed8d712d, 0x5c4b7417, 0x5ec9bd96, 0xfe07fbb6, 
            0x625516e1, 0x048269ac, 0xe0ea0e52, 0x03045fbd, 
            0x99516e44, 0x20c32bab, 0x5810ff43, 0x37f06d42
        },
        {
            0xd12a070a, 0xa660b4de, 0xf2a1ccf9, 0x1d66d275, 
            0xfa495648, 0x1c4ed4e8, 0x30979b95, 0x54e48260, 
            0x9aac069a, 0xd5b631a9, 0x74656733, 0xdd43f623, 
            0x964f48a0, 0xad2ceddb, 0xd9060a55, 0x799e3197, 
            0x330ea163, 0xc762d039, 0xe66b3a9a, 0xb111c4de, 
            0x6150b0cb, 0x1e2d99e9, 0xb7166cc7, 0x8ede80c9, 
            0xea90d9e2, 0x16d9e65f, 0xfd473598, 0x015a3abd, 
            0x9531bd11, 0x8418fe68, 0x9cd48aa6, 0x283b0e55, 
            0x9ed4aba1, 0x95ea30e3, 0x43a27f20, 0x49a5da6c, 
            0x7287cdd0, 0x74d69fac, 0x0605f6e4, 0x55ffbe2d, 
            0x702e9acf, 0x1bb957a2, 0x28830023, 0xcf35148f, 
            0xb0618b6c, 0x23ce9dcb, 0x2e2f0260, 0x6623987b, 
            0x8a7367e8, 0x8e364a52, 0xab465221, 0x7ede36ba, 
            0x93915728, 0x000c153b, 0xfa19e8ab, 0x27876233, 
            0xd172c4d6, 0xaf906e8a, 0x620f11b5, 0xad139bed, 
            0x50a7ad01, 0xd6a7f5a8, 0x65ad683d, 0x0e825684, 
            0xa674036a, 0x7a1b1a94, 0x433cc1eb, 0x21063ff9, 
            0x716e8930, 0x8e812a0b, 0xa73b312f, 0xa581e576, 
            0x22ed7dfd, 0x7428253f, 0xfaab8c5f, 0x6d9719fc, 
            0x1b38e23f, 0x73c4176b, 0x75341560, 0x95548909, 
            0x33cc0054, 0x930df0dd, 0x7b0b0598, 0x2662fbea, 
            0x90c6670d, 0x32c8e590, 0x99bde667, 0xab50f431, 
            0xa4cafe90, 0x2ba2e258, 0x90a627c4, 0xdf0babb5, 
            0x6e010af7, 0x6aee21a4, 0x195ae2ca, 0x80f5e3f7, 
            0x33c9fbeb, 0xb08f9bf2, 0x9a7afbfd, 0x6793573d, 
            0x06027dfc, 0x5c948af0, 0xb0338e69, 0xadb51b5f, 
            0x167836f9, 0x04211d74, 0x6e26d700, 0x6b6fa535, 
            0x712e39e9, 0x029a0484, 0x3fca9f5d, 0xb9cb2eeb, 
            0x63d93343, 0x6c27d2fa, 0xba30ad09, 0x6e53eed5, 
            0xf20746b6, 0xdb64a57d, 0x8c7e7a45, 0x4592cdea, 
            0x3e1795a6, 0x1d980c11, 0xa3d65f9c, 0xb28b3e71, 
            0x838f0a38, 0x1d6755ea, 0x55ec159d, 0x45a30f3e, 
            0xf0a4d6ee, 0x70509590, 0xfd1717d6, 0xc76a3b2d, 
            0xd493a615, 0x91f555a9, 0x802ed79b, 0x86e187f0, 
            0xfe77e9dd, 0x90afb7ae, 0x3945bda8, 0xd3e37428, 
            0x9747a30c, 0xbd342ae3, 0xe5dcab04, 0x40275b79, 
            0xfb6fb86c, 0xc6ff72e8, 0xa735d363, 0xcddb08f2, 
            0x4098f61a, 0xae339d78, 0x6ed90b27, 0x5f90ed89, 
            0xddf3d806, 0x1568abe6, 0x1fc57688, 0x672e7c31, 
            0xa14e8857, 0x51ca3386, 0x4d09a2af, 0x1a1fbfe3, 
            0x4df8cf8e, 0xb4ddb5b8, 0xa0104103, 0xd7e5d8dd, 
            0xb364e771, 0xe82cad7e, 0x5878e085, 0xb5e3af18, 
            0xbf3517dd, 0x7ebf45bd, 0xeb899ba4, 0x1b6d517e, 
            0x10c8b82c, 0xeb064b66, 0x82d566f8, 0x90ee27d4, 
            0x7c6479bd, 0xf28df432, 0x52e8494c, 0xce89144d, 
            0xa3fb795c, 0x05447c01, 0xfabe94bd, 0x7c25cb83, 
            0x9358a1e7, 0xecd82b87, 0xf0602d7e, 0xf2e43513, 
            0x58e0db62, 0xf0c8276b, 0x7e3a5ab4, 0x4078b561, 
            0xf40bc8f7, 0xe42f6aee, 0x8164ebbb, 0x27725340, 
            0x0e38559c, 0xd69bb996, 0x89e309bf, 0x785cdd65, 
            0x191170a9, 0x99569485, 0x65e6a5a4, 0xec62caf4, 
            0xe1f7482d, 0x38ce7f9c, 0xb8413426, 0x01f104e0, 
            0x08a575f0, 0x57724708, 0x069f3d3e, 0x2668c241, 
            0x05f3a57b, 0x8cd7a804, 0x75311bc9, 0xdc95edcd, 
            0x711ffe10, 0x04cf9fe3, 0xfa07f9c3, 0xd0824697, 
            0x956b28e6, 0x2b695f16, 0xee159a44, 0xbb5170a8, 
            0xc1acc196, 0xb48cc1e8, 0x6de6213c, 0x77e2552e, 
            0xf5056777, 0x955cdc56, 0x97b005db, 0xe09fc901, 
            0x2319ba93, 0x241057b2, 0xd70dfb8e, 0x709dc2b3, 
            0x730be4a0, 0x62bc71d6, 0xabfe0cae, 0x9d4c3a17, 
            0xb6c2a1bf, 0x7f6f1013, 0x43475bbf, 0x8708c7c9, 
            0xd8f326bd, 0xb0a32cd7, 0x8a760a17, 0xd317c63b, 
            0x84335e63, 0xa937c2ec, 0x3ecc5557, 0x79610b38, 
            0x8da8781a, 0xb5dcde36, 0xb82de4b9, 0x00785c59
        },
        {
            0xbf5ae857, 0xbda8d576, 0xee333120, 0x1a29fde9, 
            0xdc24db4c, 0xbfa57e94, 0xb7e8d4e3, 0xc1816bb1, 
            0x1c92ea1d, 0x95fdd7d6, 0x2321164b, 0x6992ca56, 
            0xdfb72d5b, 0x943db510, 0xe0a398b0, 0xaf32ac84, 
            0xb6aaa704, 0x5070ae54, 0x6b480fbf, 0x63cb067b, 
            0xbd055592, 0x49c44148, 0x763bae92, 0xccc6946a, 
            0x35a0a92d, 0x6f2d63ad, 0x27bf8b04, 0x43a50f44, 
            0x7c92e1d5, 0xc0eaebce, 0x71508149, 0x5054bd54, 
            0x75185cb7, 0x79c049d0, 0x921b459c, 0x53c11d52, 
            0x8f0c570e, 0x8ed5895d, 0x9479710a, 0x013cc9c2, 
            0xf122336a, 0x851b8214, 0x209ba361, 0xda607067, 
            0x0e95ec3b, 0xe0d0f2d0, 0x40d90e84, 0xf50ae203, 
            0x372a6d08, 0x5d935429, 0xf7960712, 0x8fb7c6a4, 
            0x9946822d, 0x6ec1e889, 0x4b3a0d91, 0xea92b3eb, 
            0x02a915bb, 0x0faa8be7, 0x32b4de8f, 0x4da14705, 
            0x445edbf7, 0x0527c9f7, 0x1ce0ced5, 0x42bc2bc4, 
            0x5a0cece9, 0xbf2980bb, 0x2d111ca2, 0x41f720a1, 
            0x82eaafc9, 0x9f3c6867, 0xca0faeb0, 0x3d958fd9, 
            0xb6797a3b, 0x208d4c1b, 0x77bfa5ce, 0x02f7978d, 
            0x3c7bebf9, 0x8c601e0d, 0xbe3be004, 0xe2f1a904, 
            0x077cdeb0, 0xf5edba20, 0x0cb11ce6, 0x43f111b5, 
            0x0ef735d3, 0x0f480ed7, 0xcd720d35, 0xff2bf093, 
            0xfa078d03, 0x30b21e74, 0x7cc5ac80, 0xef2d6f73, 
            0xfce89815, 0x15de05a5, 0x640e331f, 0xcc25bc71, 
            0x872c44bc, 0x811fdac1, 0x1f68b765, 0xfdf28d74, 
            0x5e65d9a2, 0xee37701e, 0xa56a33a0, 0x78e674b6, 
            0x3ff71c80, 0x3d157751, 0x57b6e79f, 0xa7a90f15, 
            0x81ebae19, 0x3bbd29f5, 0xf19b68e1, 0xe4d3d315, 
            0xef4be550, 0x4a0430f1, 0xe5bbf62f, 0xac3b585d, 
            0x3fe3d3b9, 0x108bd3c9, 0xe6b72729, 0xe980b323, 
            0x23d7ff4a, 0x460d8d03, 0xf5f0dce1, 0x39641714, 
            0xaa1db81e, 0x80b6be66, 0xa8cd1311, 0xc217883b, 
            0xe7df6066, 0x41bcf7d3, 0x6c1a6ae9, 0x4c6dd0a6, 
            0x2a00926f, 0x18b693fc, 0xd849c0ca, 0x2da0da46, 
            0x36b9a552, 0x116d8c9e, 0x538fff76, 0xc88b9635, 
            0x98f7d193, 0xfff5488a, 0xf8ee04d6, 0x09570a39, 
            0x14618ff3, 0x196b7539, 0xd0b29661, 0x7884bee5, 
            0xd33d638c, 0xc7d06371, 0x22793f88, 0xac16e4f2, 
            0xb6f93896, 0x2cb119f8, 0x6da2d6e8, 0x2753abdb, 
            0x67eb3b25, 0x9eb14126, 0xc9be26b8, 0xf99fb607, 
            0x6455f80e, 0xdd14df31, 0x5f7a57f1, 0x149d59ea, 
            0xe2d37a1f, 0xacb83090, 0x5ee9949d, 0x6dc24de7, 
            0x4ec727bc, 0x4a5fc15a, 0x55a0c6fc, 0x76a704a4, 
            0x8483e93f, 0x85e15c70, 0x07336032, 0xa6a25f4b, 
            0x4a06b33f, 0xf42eb26f, 0xa1761059, 0x31a0474c, 
            0x76855a3d, 0xe58f6263, 0xb0fd98bf, 0x5fe4c3f6, 
            0x613a89f9, 0x738645f3, 0xeeda3e6d, 0xb705bd4b, 
            0x64ecebb6, 0x49fe3cff, 0xbc6ecb2e, 0x9c09812d, 
            0x770395d6, 0x05a703d9, 0xe8b53b29, 0x46b038a0, 
            0xb043bc8e, 0x7ff532d2, 0xf9c84f7e, 0xfb693afa, 
            0x781d8c65, 0xd1377314, 0xa1d3dc79, 0x322b202a, 
            0x9fe7b688, 0x7bb0f4f4, 0x1febe72a, 0x04fa0e1d, 
            0x1aedf076, 0x52961d23, 0x01cf0f06, 0xb2a6849e, 
            0xd36cf1d6, 0x4fb6a4b6, 0xd0f634ab, 0xb2a764b7, 
            0xf033b020, 0xf6d40c61, 0x00c31e7a, 0x2c3f8f16, 
            0xcdf46349, 0xa08917e5, 0x74e07feb, 0x12f43124, 
            0xabce5f8c, 0xe757b321, 0x983c4ab7, 0xe189dba0, 
            0x22c64ed8, 0x2766a289, 0xcb144ae6, 0xa0adee0a, 
            0x79458cd4, 0x4a079f10, 0x645fc852, 0x232d4f23, 
            0xebb45cb4, 0xbc641269, 0xb150aeb1, 0x2198b341, 
            0x3b70232e, 0xdaa7703d, 0xe0d7ca8b, 0x8a1d6994, 
            0x0da951a4, 0x54ca330a, 0x5765830b, 0xfecec571, 
            0x9c33399c, 0x7d5f0060, 0xefc9bd5f, 0xbdebd4ac, 
            0xd5e95fcb, 0x9e6020af, 0xb76166b1, 0xc8bd2e6b
        },
        {
            0xde7a876a, 0xe307e8a5, 0x10e08c98, 0xd4d0c9bc, 
            0x2b3d54e2, 0x4ba0f0a1, 0x6a6b1ae2, 0xfbbc9c1e, 
            0x6952b266, 0x6d9b763b, 0x74d66304, 0x21ba2bd7, 
            0x620ec570, 0x9b61b1d8, 0x8f2facd4, 0x5bc9f6ac, 
            0x446a6d3d, 0x006bfcb6, 0x452c8b1e, 0x9fdeac70, 
            0x8c4b7f4e, 0xfddb86cf, 0xfe2e53dd, 0x0f4a3d2a, 
            0x0739111a, 0x120208db, 0x7553185c, 0x5262f7ad, 
            0xc95c9292, 0x8b2043a1, 0x52c75f13, 0x7ddd68ab, 
            0xcf896bc3, 0xc3112981, 0x4902da2d, 0xaf7d844e, 
            0xdc825c26, 0x80130612, 0x70c5f4e0, 0xac27ea6b, 
            0x3015b697, 0x5ade02e8, 0x9baa9615, 0xc5da22bd, 
            0x67954a6b, 0x15822fa1, 0x502d2f92, 0xd6746958, 
            0x950a058c, 0x7a799bcb, 0x68a6a550, 0x6244070f, 
            0xbd2578de, 0x624507df, 0x1bd6cb27, 0xec0f1536, 
            0x8eaa8367, 0x64ba471d, 0xd3a9b67a, 0xb67c47e6, 
            0x609b3cb4, 0x25a7c918, 0x2d965795, 0x105fadde, 
            0xb7e69e7a, 0x5cbd87b3, 0x430b6079, 0x0afd5fbf, 
            0x7bd5afe8, 0xb58e4520, 0xa592dfed, 0x540e3dff, 
            0xb6acecd7, 0xc3058b4c, 0x213fd54d, 0x779eb523, 
            0x02caefe4, 0xacdf922c, 0xb9db4ab4, 0xefd86709, 
            0xf9db6149, 0xb6640863, 0x68437f9e, 0x466dd8f1, 
            0xbc70d726, 0x6d007afc, 0x073f57e1, 0x0e1c77d2, 
            0xa9aed740, 0x52cd05b6, 0xe6554fa0, 0x7c99e11c, 
            0x967baa86, 0x7e332bdf, 0x0a2d7857, 0x5b6138b2, 
            0xa0469567, 0x08071989, 0x10159a92, 0x2926604f, 
            0x3ce35d45, 0x875548a2, 0x3743c4f8, 0x739d6a89, 
            0x24877f48, 0xa6d3a722, 0x06ca2747, 0x27773089, 
            0xe9840b7b, 0x7b0870e3, 0xc71d7251, 0xcd9c35f7, 
            0x2732580c, 0x5dafca36, 0xaa3407e2, 0x33c96316, 
            0x5ada6964, 0x70682ab9, 0x410d5f43, 0x2a43e494, 
            0xcae17789, 0xfa0a37b5, 0x125c3986, 0x2c35e5e6, 
            0x06853fad, 0x9f2be6c8, 0x1892c32b, 0x72330d8b, 
            0xf4873415, 0x44bc1729, 0x0484ca9b, 0xbe5c233a, 
            0x1af66a07, 0xd1e1b42b, 0x314cff4b, 0x86288346, 
            0xdb7a4340, 0xbd708c1b, 0xcd2b90cc, 0xc2a4eeb5, 
            0x48a4674f, 0xd91d2af0, 0x574081ac, 0xcb0c35a2, 
            0xf3e774e5, 0x38545141, 0x71c30fdf, 0x8d734a1d, 
            0xfb319e73, 0x5e91b02e, 0x3930ec70, 0x8eaeb2f1, 
            0x8011b9a3, 0xce45b39d, 0x24f3110b, 0x1b782e56, 
            0x52a73ef8, 0x2206c53b, 0x4ecb93ab, 0x74c24138, 
            0xfb0c87fa, 0x3e40ae6b, 0x9ab7bb34, 0x0362f2f0, 
            0x9f39d3eb, 0xabbec808, 0x56c5206e, 0xa2563c3d, 
            0x1e61546d, 0x8bb7f554, 0x6d6f9d36, 0x1c411dde, 
            0x909dbb91, 0xbbbedec7, 0x71bdaaa3, 0x03c6f17f, 
            0x2dc44f9c, 0x4bd0d060, 0xcd34725a, 0xf69e7525, 
            0xea05b7e8, 0x72b79414, 0xc743099c, 0x713ee04a, 
            0x26dfe596, 0x7675bb63, 0x8f1e29f8, 0x4d86ccef, 
            0xd916b87a, 0xe11a99cd, 0x13591e15, 0xfd07aa9d, 
            0xe45b8141, 0x8b2ee1fa, 0xc45b54b3, 0x748f5275, 
            0xc0464bc7, 0x89204fe5, 0xb8e26306, 0x18483b39, 
            0xc3dd4d54, 0xec24a2d9, 0x13d9d118, 0x5d7b9573, 
            0x1ef5df3f, 0x131e1d5c, 0x600ada1a, 0x77d02602, 
            0x373fe08d, 0x0cfc01c2, 0x18f8df70, 0x2ab1e54d, 
            0x32c8d8cc, 0xed729557, 0xe1763759, 0x3b728ad3, 
            0x7a4013e0, 0x6576ab80, 0x92c06264, 0x9addc7f9, 
            0xcd0b6262, 0xc25ad1dc, 0x1bb8933a, 0xc6ec7b83, 
            0xd8564ff9, 0x9507ef98, 0xda64ea3a, 0xbab5a3c3, 
            0x63170449, 0x08b68943, 0xfb216862, 0x8fd7d076, 
            0x35a660a5, 0xa8a79113, 0x2b056989, 0x8ce8e346, 
            0xafaf4b10, 0x11029a34, 0xdbab96af, 0xd04c8f8a, 
            0x09e16462, 0x7e6458a9, 0xba3baa2d, 0xd0430d09, 
            0x4fe41bbb, 0x7bf5189f, 0x6aad1d94, 0xa3ab4406, 
            0xc36803c4, 0x166d6aed, 0xb85450c5, 0x3264794e, 
            0xe39cadd8, 0x1689c696, 0x73d47522, 0xb025ed7a
        },
    };
    unsigned int datal = 0x00000000, datar = 0x00000000, data;
    BLOWFISH_CTX ctx;

    for (i = 0; i < 4; i++) {
    for (j = 0; j < 256; j++)
      ctx.S[i][j] = ORIG_S[i][j];
    }

    j = 0;
    for (i = 0; i < N + 2; ++i) {
        data = 0x00000000;
        ctx.P[i] = ORIG_P[i] ^ key[i % 8];
    }
    
    for(i = 0; i < 18; i+= 2) {
        blowfish_enc(&ctx, &datal, &datar);
        ctx.P[i] = datal;
        ctx.P[i + 1] = datar;
    }

    for (i = 0; i < 4; ++i) {
    for (j = 0; j < 256; j += 2) {
      blowfish_enc(&ctx, &datal, &datar);
      ctx.S[i][j] = datal;
      ctx.S[i][j + 1] = datar;
    }
  }

    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedP, ctx.P, 18);
    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedS[0], ctx.S[0], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedS[1], ctx.S[1], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedS[2], ctx.S[2], 256);
    TEST_ASSERT_EQUAL_UINT_ARRAY(expectedS[3], ctx.S[3], 256);
}

TEST(Crypto, blowfish_enc_128)
{
    unsigned int *L, *R;
    L = (unsigned int *) malloc(sizeof(unsigned int));
    R = (unsigned int *) malloc(sizeof(unsigned int));
    int i, j;
    unsigned int expected[4] = {0x24B9C5E1, 0xB06FBF71, 0x5527E5FA, 0x3502EE1A};

    BLOWFISH_CTX ctx;

    blowfish_init(&ctx, key, 4);
    for(i = 0; i < 2; i++) {
        *L = plan[i*2];
        *R = plan[i*2+1];

        blowfish_enc(&ctx, L, R);

        cipher[i*2]   = *L;
        cipher[i*2+1] = *R;
    }

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
    free(L);
    free(R);
}

TEST(Crypto, blowfish_enc_192)
{
    unsigned int *L, *R;
    L = (unsigned int *) malloc(sizeof(unsigned int));
    R = (unsigned int *) malloc(sizeof(unsigned int));
    int i, j;
    unsigned int expected[4] = {0xA5E31925, 0x25FE7048, 0x4254F298, 0x4B71D955};

    BLOWFISH_CTX ctx;

    blowfish_init(&ctx, key, 6);
    for(i = 0; i < 2; i++) {
        *L = plan[i*2];
        *R = plan[i*2+1];

        blowfish_enc(&ctx, L, R);

        cipher[i*2]   = *L;
        cipher[i*2+1] = *R;
    }

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
    free(L);
    free(R);
}

TEST(Crypto, blowfish_enc_256)
{
   unsigned int *L, *R;
    L = (unsigned int *) malloc(sizeof(unsigned int));
    R = (unsigned int *) malloc(sizeof(unsigned int));
    int i, j;
    unsigned int expected[4] = {0x24B9C5E1, 0xB06FBF71, 0x5527E5FA, 0x3502EE1A};

    BLOWFISH_CTX ctx;

    blowfish_init(&ctx, key, 8);
    for(i = 0; i < 2; i++) {
        *L = plan[i*2];
        *R = plan[i*2+1];

        blowfish_enc(&ctx, L, R);

        cipher[i*2]   = *L;
        cipher[i*2+1] = *R;
    }

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
    free(L);
    free(R);
}

//-----------------------------------------------------------------------------
// BLOWFISH DEC
//-----------------------------------------------------------------------------
TEST(Crypto, blowfish_dec_128)
{
    unsigned int *L, *R;
    L = (unsigned int *) malloc(sizeof(unsigned int));
    R = (unsigned int *) malloc(sizeof(unsigned int));
    int i, j;
    unsigned int encrypted[4] = {0x24B9C5E1, 0xB06FBF71, 0x5527E5FA, 0x3502EE1A};

    BLOWFISH_CTX ctx;

    blowfish_init(&ctx, key, 4);
    for(i = 0; i < 2; i++) {
        *L = encrypted[i*2];
        *R = encrypted[i*2+1];

        blowfish_dec(&ctx, L, R);

        cipher[i*2]   = *L;
        cipher[i*2+1] = *R;
    }

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
    free(L);
    free(R);
}

TEST(Crypto, blowfish_dec_192)
{
    unsigned int *L, *R;
    L = (unsigned int *) malloc(sizeof(unsigned int));
    R = (unsigned int *) malloc(sizeof(unsigned int));
    int i, j;
    unsigned int encrypted[4] = {0xA5E31925, 0x25FE7048, 0x4254F298, 0x4B71D955};

    BLOWFISH_CTX ctx;

    blowfish_init(&ctx, key, 6);
    for(i = 0; i < 2; i++) {
        *L = encrypted[i*2];
        *R = encrypted[i*2+1];

        blowfish_dec(&ctx, L, R);

        cipher[i*2]   = *L;
        cipher[i*2+1] = *R;
    }

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
    free(L);
    free(R);
}

TEST(Crypto, blowfish_dec_256)
{
   unsigned int *L, *R;
    L = (unsigned int *) malloc(sizeof(unsigned int));
    R = (unsigned int *) malloc(sizeof(unsigned int));
    int i, j;
    unsigned int encrypted[4] = {0x24B9C5E1, 0xB06FBF71, 0x5527E5FA, 0x3502EE1A};

    BLOWFISH_CTX ctx;

    blowfish_init(&ctx, key, 8);
    for(i = 0; i < 2; i++) {
        *L = encrypted[i*2];
        *R = encrypted[i*2+1];

        blowfish_dec(&ctx, L, R);

        cipher[i*2]   = *L;
        cipher[i*2+1] = *R;
    }

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
    free(L);
    free(R);
}

//-----------------------------------------------------------------------------
// BLOWFISH 128
//-----------------------------------------------------------------------------
TEST(Crypto, blowfish_128_should_enc)
{
    unsigned int expected[4] = {0x24B9C5E1, 0xB06FBF71, 0x5527E5FA, 0x3502EE1A};

    blowfish_128(key, plan, 4, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, blowfish_192_should_enc)
{
    unsigned int expected[4] = {0xA5E31925, 0x25FE7048, 0x4254F298, 0x4B71D955};

    blowfish_128(key, plan, 5, 5, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, blowfish_256_should_enc)
{
    unsigned int expected[4] = {0x24B9C5E1, 0xB06FBF71, 0x5527E5FA, 0x3502EE1A};

    blowfish_128(key, plan, 6, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, blowfish_128_should_dec)
{
    unsigned int encrypted[4] = {0x24B9C5E1, 0xB06FBF71, 0x5527E5FA, 0x3502EE1A};

    blowfish_128(key, encrypted, 4, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
}

TEST(Crypto, blowfish_192_should_dec)
{
    unsigned int encrypted[4] = {0xA5E31925, 0x25FE7048, 0x4254F298, 0x4B71D955};

    blowfish_128(key, encrypted, 5, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
}

TEST(Crypto, blowfish_256_should_dec)
{
    unsigned int encrypted[4] = {0x24B9C5E1, 0xB06FBF71, 0x5527E5FA, 0x3502EE1A};

    blowfish_128(key, encrypted, 6, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
}

TEST(Crypto, blowfish_128_should_enc_dec_key_128)
{
    int i;
    unsigned int auxKey[4] = {0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF};
    unsigned int expected[4];

    for(i=0; i<4; i++)
        expected[i] = plan[i];

    blowfish_128(auxKey, plan, 4, 0, cipher);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    blowfish_128(auxKey, plan, 4, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, blowfish_192_should_enc_dec_key_192)
{
    int i;
    unsigned int auxKey[6] = {0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF};
    unsigned int expected[4];

    for(i=0; i<4; i++)
        expected[i] = plan[i];

    blowfish_128(auxKey, plan, 5, 0, cipher);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    blowfish_128(auxKey, plan, 5, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, blowfish_256_should_enc_dec_key_256_plus)
{
    int i;
    unsigned int auxKey[10] = {0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF};
    unsigned int expected[4];

    for(i=0; i<4; i++)
        expected[i] = plan[i];

    blowfish_128(auxKey, plan, 6, 0, cipher);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    blowfish_128(auxKey, plan, 6, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

//-----------------------------------------------------------------------------
// AES getSBoxValue
//-----------------------------------------------------------------------------
TEST(Crypto, aes_getSBoxValue_128)
{
    int i;
    uint8_t expected[4] = {
        0x00000095, 0x000000ae, 0x000000df, 0x0000001d
    };

    uint8_t tempa[4] = {
        0x000000ad, 0x000000be, 0x000000ef, 0x000000de
    };

    for(i = 0; i < 4; i++) {
        tempa[i] = getSBoxValue(tempa[i]);
        TEST_ASSERT_EQUAL_UINT8(expected[i], tempa[i]); 
    }
}

TEST(Crypto, aes_getSBoxValue_192)
{
    int i;
    uint8_t expected[4] = {
        0x00000026, 0x0000006e, 0x00000085, 0x0000007c
    };

    uint8_t tempa[4] = {
        0x00000023, 0x00000045, 0x00000067, 0x00000001
    };

    for(i = 0; i < 4; i++) {
        tempa[i] = getSBoxValue(tempa[i]);
        TEST_ASSERT_EQUAL_UINT8(expected[i], tempa[i]); 
    }
}

TEST(Crypto, aes_getSBoxValue_256)
{
    int i;
    uint8_t expected[4] = {
        0x00000095, 0x000000ae, 0x000000df, 0x0000001d
    };

    uint8_t tempa[4] = {
        0x000000ad, 0x000000be, 0x000000ef, 0x000000de
    };

    for(i = 0; i < 4; i++) {
        tempa[i] = getSBoxValue(tempa[i]);
        TEST_ASSERT_EQUAL_UINT8(expected[i], tempa[i]); 
    }
}

//-----------------------------------------------------------------------------
// AES getSBoxInvert
//-----------------------------------------------------------------------------
TEST(Crypto, aes_getSBoxInvert_128)
{
    int i, j;
    uint8_t expected[4][4] = {
        {
            0x00000084, 0x0000006d, 0x000000ea, 0x00000014
        },
        {
            0x000000dd, 0x00000072, 0x00000090, 0x0000001d 
        },
        {
            0x000000f0, 0x0000000b, 0x00000010, 0x0000000b
        },
        {
            0x000000b3, 0x0000005f, 0x00000067, 0x000000ee
        }
    };

    uint8_t stateAux[4][4] = {
        {
            0x0000005f, 0x0000003c, 0x00000087, 0x000000fa
        },
        {
            0x000000c1, 0x00000040, 0x00000060, 0x000000a4 
        },
        {
            0x0000008c, 0x0000002b, 0x000000ca, 0x0000002b
        },
        {
            0x0000006d, 0x000000cf, 0x00000085, 0x00000028
        }
    };

    for(i = 0; i < 4; ++i) {
        for(j = 0; j < 4; ++j) {
            state[i][j] = stateAux[i][j];
        }
    }

    for(i = 0; i < 4; ++i) {
        for(j = 0; j < 4; ++j) {
            state[j][i] = getSBoxInvert(state[j][i]);
        }
    }

    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected[0], state[0], 4);
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected[1], state[1], 4);
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected[2], state[2], 4);
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected[3], state[3], 4);
}

TEST(Crypto, aes_getSBoxInvert_192)
{
    int i, j;
    uint8_t expected[4][4] = {
        {
            0x000000be, 0x000000ad, 0x000000ee, 0x00000036           
        },
        {
            0x0000000b, 0x000000dd, 0x000000f1, 0x00000064
        },
        {
            0x000000fe, 0x000000dc, 0x000000c7, 0x000000ad 
        },
        {
            0x00000087, 0x000000ef, 0x0000006e, 0x0000005c
        }
    };

    uint8_t stateAux[4][4] = {
        {
            0x000000ae, 0x00000095, 0x00000028, 0x00000005 
        },
        {
            0x0000002b, 0x000000c1, 0x000000a1, 0x00000043
        },
        {
            0x000000bb, 0x00000086, 0x000000c6, 0x00000095
        },
        {
            0x00000017, 0x000000df, 0x0000009f, 0x0000004a
        }
    };

    for(i = 0; i < 4; ++i) {
        for(j = 0; j < 4; ++j) {
            state[i][j] = stateAux[i][j];
        }
    }

    for(i = 0; i < 4; ++i) {
        for(j = 0; j < 4; ++j) {
            state[j][i] = getSBoxInvert(state[j][i]);
        }
    }

    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected[0], state[0], 4);
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected[1], state[1], 4);
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected[2], state[2], 4);
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected[3], state[3], 4);
}

TEST(Crypto, aes_getSBoxInvert_256)
{
    int i, j;
    uint8_t expected[4][4] = {
        {
            0x000000f6, 0x00000044, 0x000000fb, 0x0000001f 
        },
        {
            0x00000028, 0x000000f0, 0x00000087, 0x00000055
        },
        {
            0x000000eb, 0x0000000a, 0x000000d8, 0x00000063
        },
        {
            0x000000ae, 0x0000004d, 0x000000cf, 0x00000083
        }
    };

    uint8_t stateAux[4][4] = {
        {
            0x00000042, 0x0000001b, 0x0000000f, 0x000000c0
        },
        {
            0x00000034, 0x0000008c, 0x00000017, 0x000000fc
        },
        {
            0x000000e9, 0x00000067, 0x00000061, 0x000000fb
        },
        {
            0x000000e4, 0x000000e3, 0x0000008a, 0x000000ec
        }
    };

    for(i = 0; i < 4; ++i) {
        for(j = 0; j < 4; ++j) {
            state[i][j] = stateAux[i][j];
        }
    }

    for(i = 0; i < 4; ++i) {
        for(j = 0; j < 4; ++j) {
            state[j][i] = getSBoxInvert(state[j][i]);
        }
    }

    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected[0], state[0], 4);
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected[1], state[1], 4);
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected[2], state[2], 4);
    TEST_ASSERT_EQUAL_UINT8_ARRAY(expected[3], state[3], 4);
}

//-----------------------------------------------------------------------------
// AES
//-----------------------------------------------------------------------------
TEST(Crypto, aes_should_enc_128)
{
    unsigned int expected[4] = {0x237549D4, 0xCDCEA7BE, 0x0FE7D162, 0xCC9161D3};

    aes(key, plan, 1, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, aes_should_enc_192)
{
    unsigned int expected[4] = {0xEBB4CD9E, 0xDA7CBDE0, 0x9E520F4C, 0x54BE5A98};

    aes(key, plan, 2, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, aes_should_enc_256)
{
    unsigned int expected[4] = {0x206BF119, 0x7A085AC8, 0xB31B2AD0, 0x4843FFC1};

    aes(key, plan, 3, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, aes_should_dec_128)
{
    unsigned int encrypted[4] = {0x237549D4, 0xCDCEA7BE, 0x0FE7D162, 0xCC9161D3};

    aes(key, encrypted, 1, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
}

TEST(Crypto, aes_should_dec_192)
{
    unsigned int encrypted[4] = {0xEBB4CD9E, 0xDA7CBDE0, 0x9E520F4C, 0x54BE5A98};

    aes(key, encrypted, 2, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
}

TEST(Crypto, aes_should_dec_256)
{
    unsigned int encrypted[4] = {0x206BF119, 0x7A085AC8, 0xB31B2AD0, 0x4843FFC1};

    aes(key, encrypted, 3, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(plan, cipher, 4);
}

TEST(Crypto, aes_should_enc_dec_128_key_128)
{
    int i;
    unsigned int auxKey[4] = {0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF};
    unsigned int expected[4];

    for(i=0; i<4; i++)
        expected[i] = plan[i];

    aes(auxKey, plan, 1, 0, cipher);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    aes(auxKey, plan, 1, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, aes_should_enc_dec_192_key_192)
{
    int i;
    unsigned int auxKey[6] = {0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF};
    unsigned int expected[4];

    for(i=0; i<4; i++)
        expected[i] = plan[i];

    aes(auxKey, plan, 2, 0, cipher);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    aes(auxKey, plan, 2, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

TEST(Crypto, aes_should_enc_dec_256_key_256_plus)
{
    int i;
    unsigned int auxKey[10] = {0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF};
    unsigned int expected[4];

    for(i=0; i<4; i++)
        expected[i] = plan[i];

    aes(auxKey, plan, 3, 0, cipher);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    aes(auxKey, plan, 3, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}

//-----------------------------------------------------------------------------
// CRYPT
//-----------------------------------------------------------------------------
TEST(Crypto, crypt_should_encrypt_XTEA)
{
    int i;
    unsigned int expected[4] = {0x089975E9, 0x2555F334, 0xCE76E4F2, 0x4D932AB3};
    unsigned int initialPlan[4];

    for(i=0; i<4; i++)
        initialPlan[i] = plan[i];

    crypt(key, plan, 0, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    crypt(key, plan, 0, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(initialPlan, cipher, 4);
}

TEST(Crypto, crypt_should_encrypt_AES_128)
{
    int i;
    unsigned int expected[4] = {0x237549D4, 0xCDCEA7BE, 0x0FE7D162, 0xCC9161D3};
    unsigned int initialPlan[4];

    for(i=0; i<4; i++)
        initialPlan[i] = plan[i];

    crypt(key, plan, 1, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    crypt(key, plan, 1, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(initialPlan, cipher, 4);
}

TEST(Crypto, crypt_should_encrypt_AES_192)
{
    int i;
    unsigned int expected[4] = {0xEBB4CD9E, 0xDA7CBDE0, 0x9E520F4C, 0x54BE5A98};
    unsigned int initialPlan[4];

    for(i=0; i<4; i++)
        initialPlan[i] = plan[i];

    crypt(key, plan, 2, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    crypt(key, plan, 2, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(initialPlan, cipher, 4);
}

TEST(Crypto, crypt_should_encrypt_AES_256)
{
    int i;
    unsigned int expected[4] = {0x206BF119, 0x7A085AC8, 0xB31B2AD0, 0x4843FFC1};
    unsigned int initialPlan[4];

    for(i=0; i<4; i++)
        initialPlan[i] = plan[i];

    crypt(key, plan, 3, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    crypt(key, plan, 3, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(initialPlan, cipher, 4);
}

TEST(Crypto, crypt_should_encrypt_BLOWFISH_128)
{
    int i;
    unsigned int expected[4] = {0x24B9C5E1, 0xB06FBF71, 0x5527E5FA, 0x3502EE1A};
    unsigned int initialPlan[4];

    for(i=0; i<4; i++)
        initialPlan[i] = plan[i];

    crypt(key, plan, 4, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    crypt(key, plan, 4, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(initialPlan, cipher, 4);
}

TEST(Crypto, crypt_should_encrypt_BLOWFISH_192)
{
    int i;
    unsigned int expected[4] = {0xA5E31925, 0x25FE7048, 0x4254F298, 0x4B71D955};
    unsigned int initialPlan[4];

    for(i=0; i<4; i++)
        initialPlan[i] = plan[i];

    crypt(key, plan, 5, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    crypt(key, plan, 5, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(initialPlan, cipher, 4);
}

TEST(Crypto, crypt_should_encrypt_BLOWFISH_256)
{
    int i;
    unsigned int expected[4] = {0x24B9C5E1, 0xB06FBF71, 0x5527E5FA, 0x3502EE1A};
    unsigned int initialPlan[4];

    for(i=0; i<4; i++)
        initialPlan[i] = plan[i];

    crypt(key, plan, 6, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    crypt(key, plan, 6, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(initialPlan, cipher, 4);
}

TEST(Crypto, crypt_should_not_encrypt_and_decrypt)
{
    int i;
    unsigned int expected[4];

    for(i=0; i<4; i++)
        expected[i] = cipher[i];

    crypt(key, plan, 10, 1, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);

    for(i=0; i<4; i++)
        plan[i] = cipher[i];

    crypt(key, plan, 10, 0, cipher);

    TEST_ASSERT_EQUAL_UINT_ARRAY(expected, cipher, 4);
}
